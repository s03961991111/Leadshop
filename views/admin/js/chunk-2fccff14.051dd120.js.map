{"version":3,"sources":["webpack:///./src/features/coupon/send.vue?6922","webpack:///src/features/coupon/send.vue","webpack:///./src/features/coupon/send.vue?8d9e","webpack:///./src/features/coupon/send.vue","webpack:///./src/features/coupon/send.vue?c376"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","directives","name","rawName","value","expression","ref","rules","form","slot","_s","detail","over_num","expire_type","expire_day","_f","begin_time","end_time","_e","min_price","sub_price","nativeOn","$event","formatNum","apply","arguments","model","coupon_list","callback","$$v","$set","_n","item","user_list","modifiers","scopedSlots","_u","key","fn","scope","row","oauth","type","nickname","on","splice","$index","label","label_list","_l","index","stopPropagation","delLabel","disable","loading","submit","staticRenderFns","data","num","give_limit","methods","router","$router","replace","path","chooseUser","e","setLabel","$delete","_this","$refs","validate","valid","map","id","$heshop","getDetail","target","mounted","component"],"mappings":"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","file":"js/chunk-2fccff14.051dd120.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"le-matter\"},[_c('el-breadcrumb',{staticClass:\"he-link-text\",attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',[_c('he-link',{attrs:{\"href\":\"plugins/features\"}},[_vm._v(\"营销玩法\")])],1),_c('el-breadcrumb-item',{staticClass:\"he-link\"},[_c('he-link',{attrs:{\"href\":\"features/coupon/index\"}},[_vm._v(\"优惠券管理\")])],1),_c('el-breadcrumb-item',[_vm._v(\" 发放优惠券 \")])],1),_c('el-form',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],ref:\"form\",staticClass:\"le-send\",attrs:{\"label-width\":\"193px\",\"rules\":_vm.rules,\"model\":_vm.form}},[_c('div',{staticClass:\"le-card\"},[_c('div',{staticClass:\"le-card-header flex align-center\"},[_c('span'),_c('span',[_vm._v(\"基本信息\")])]),_c('div',{staticClass:\"le-card-body\"},[_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"优惠券名称\")]),_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(_vm._s(_vm.detail.name))])]),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"剩余发放总量\")]),_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(_vm._s(_vm.detail.over_num)+\"张\")])]),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"用券时间\")]),(_vm.detail.expire_type === 1)?_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(\"领券当日起\"+_vm._s(_vm.detail.expire_day)+\"天可用\")]):(_vm.detail.expire_type === 2)?_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(_vm._s(_vm._f(\"timeFormat\")(_vm.detail.begin_time,\"yyyy-mm-dd hh:MM:ss\"))+\"~\"+_vm._s(_vm._f(\"timeFormat\")(_vm.detail.end_time,\"yyyy-mm-dd hh:MM:ss\")))]):_vm._e()]),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"门槛金额\")]),_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(_vm._s(_vm.detail.min_price === 0 || _vm.detail.min_price === null ? \"无门槛\" : _vm.detail.min_price + \"元\"))])]),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"优惠金额\")]),_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(_vm._s(_vm.detail.sub_price)+\"元\")])])],1)]),_c('div',{staticClass:\"le-card\"},[_c('div',{staticClass:\"le-card-header flex align-center\"},[_c('span'),_c('span',[_vm._v(\"发放优惠券\")])]),_c('div',{staticClass:\"le-card-body\"},[_c('el-form-item',{attrs:{\"prop\":\"coupon_list[0].num\"}},[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"每人发放\")]),_c('el-input',{staticClass:\"le-form-item-small-input\",attrs:{\"maxlength\":6},nativeOn:{\"input\":function($event){return _vm.formatNum.apply(null, arguments)}},model:{value:(_vm.form.coupon_list[0].num),callback:function ($$v) {_vm.$set(_vm.form.coupon_list[0], \"num\", _vm._n($$v))},expression:\"form.coupon_list[0].num\"}},[_c('template',{slot:\"append\"},[_vm._v(\"张\")])],2)],1),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"指定用户发放\")]),_c('el-button',{directives:[{name:\"popup\",rawName:\"v-popup.chooseUser\",value:({ item: _vm.form.user_list }),expression:\"{ item: form.user_list }\",modifiers:{\"chooseUser\":true}}],staticClass:\"le-btn\",attrs:{\"width\":\"577\",\"title\":\"选择用户\",\"module\":\"users\",\"action\":\"chooseUser\"}},[_vm._v(\"选择用户 \")]),(_vm.form.user_list.length)?_c('el-table',{staticClass:\"le-users-table\",attrs:{\"data\":_vm.form.user_list,\"max-height\":\"368px\",\"row-class-name\":\"le-table-row\"}},[_c('el-table-column',{attrs:{\"label\":\"用户ID\",\"width\":\"120\",\"prop\":\"id\"}}),_c('el-table-column',{attrs:{\"label\":\"用户昵称\",\"prop\":\"nickname\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.oauth.type === 'weapp')?_c('he-icon',{attrs:{\"size\":\"18px\",\"type\":\"le-icon-xiaochengxu\"}}):(scope.row.oauth.type === 'wechat')?_c('he-icon',{attrs:{\"size\":\"18px\",\"type\":\"le-icon-wehcat\"}}):_vm._e(),_vm._v(\" \"+_vm._s(scope.row.nickname)+\" \")]}}],null,false,685763140)}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"160\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',{staticClass:\"le-button-text\",on:{\"click\":function($event){return _vm.form.user_list.splice(scope.$index, 1)}}},[_vm._v(\"移除\")])]}}],null,false,3081881386)})],1):_vm._e()],1),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"指定用户标签发放\")]),_c('el-button',{directives:[{name:\"popup\",rawName:\"v-popup.chooseLabel\",value:({ label: _vm.form.label_list }),expression:\"{ label: form.label_list }\",modifiers:{\"chooseLabel\":true}}],staticClass:\"le-btn\",attrs:{\"action\":\"setLabel\",\"module\":\"users\",\"title\":\"选择用户标签\",\"width\":\"704\"}},[_vm._v(\"选择用户标签 \")]),_c('div',{staticClass:\"le-user-label flex flex-wrap\"},_vm._l((_vm.form.label_list),function(item,index){return _c('div',{key:index,staticClass:\"le-tag\"},[_c('span',[_vm._v(_vm._s(item.name))]),_c('i',{staticClass:\"el-tag__close el-icon-close\",on:{\"click\":function($event){$event.stopPropagation();return _vm.delLabel(item, index)}}})])}),0)],1)],1)])]),(!_vm.disable)?_c('div',{staticClass:\"le-cardpin\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.loading,\"loading\":_vm.loading},on:{\"click\":function($event){return _vm.submit()}}},[_vm._v(\"提交\")])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"le-matter\">\r\n    <el-breadcrumb class=\"he-link-text\" separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item>\r\n        <he-link href=\"plugins/features\">营销玩法</he-link>\r\n      </el-breadcrumb-item>\r\n      <el-breadcrumb-item class=\"he-link\">\r\n        <he-link href=\"features/coupon/index\">优惠券管理</he-link>\r\n      </el-breadcrumb-item>\r\n      <el-breadcrumb-item> 发放优惠券 </el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <el-form\r\n      label-width=\"193px\"\r\n      ref=\"form\"\r\n      class=\"le-send\"\r\n      :rules=\"rules\"\r\n      :model=\"form\"\r\n      v-loading=\"loading\"\r\n    >\r\n      <div class=\"le-card\">\r\n        <div class=\"le-card-header flex align-center\">\r\n          <span></span>\r\n          <span>基本信息</span>\r\n        </div>\r\n        <div class=\"le-card-body\">\r\n          <el-form-item>\r\n            <span slot=\"label\" class=\"le-form-item__label\">优惠券名称</span>\r\n            <span class=\"le-form-item__text\">{{ detail.name }}</span>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <span slot=\"label\" class=\"le-form-item__label\">剩余发放总量</span>\r\n            <span class=\"le-form-item__text\">{{ detail.over_num }}张</span>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <span slot=\"label\" class=\"le-form-item__label\">用券时间</span>\r\n            <span class=\"le-form-item__text\" v-if=\"detail.expire_type === 1\"\r\n              >领券当日起{{ detail.expire_day }}天可用</span\r\n            >\r\n            <span\r\n              class=\"le-form-item__text\"\r\n              v-else-if=\"detail.expire_type === 2\"\r\n              >{{ detail.begin_time | timeFormat(\"yyyy-mm-dd hh:MM:ss\") }}~{{\r\n                detail.end_time | timeFormat(\"yyyy-mm-dd hh:MM:ss\")\r\n              }}</span\r\n            >\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <span slot=\"label\" class=\"le-form-item__label\">门槛金额</span>\r\n            <span class=\"le-form-item__text\">{{\r\n              detail.min_price === 0 || detail.min_price === null\r\n                ? \"无门槛\"\r\n                : detail.min_price + \"元\"\r\n            }}</span>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <span slot=\"label\" class=\"le-form-item__label\">优惠金额</span>\r\n            <span class=\"le-form-item__text\">{{ detail.sub_price }}元</span>\r\n          </el-form-item>\r\n        </div>\r\n      </div>\r\n      <div class=\"le-card\">\r\n        <div class=\"le-card-header flex align-center\">\r\n          <span></span>\r\n          <span>发放优惠券</span>\r\n        </div>\r\n        <div class=\"le-card-body\">\r\n          <el-form-item prop=\"coupon_list[0].num\">\r\n            <span slot=\"label\" class=\"le-form-item__label\">每人发放</span>\r\n            <el-input\r\n              class=\"le-form-item-small-input\"\r\n              v-model.number=\"form.coupon_list[0].num\"\r\n              :maxlength=\"6\"\r\n              @input.native=\"formatNum\"\r\n            >\r\n              <template slot=\"append\">张</template>\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <span slot=\"label\" class=\"le-form-item__label\">指定用户发放</span>\r\n            <el-button\r\n              class=\"le-btn\"\r\n              width=\"577\"\r\n              title=\"选择用户\"\r\n              module=\"users\"\r\n              v-popup.chooseUser=\"{ item: form.user_list }\"\r\n              action=\"chooseUser\"\r\n              >选择用户\r\n            </el-button>\r\n            <el-table\r\n              v-if=\"form.user_list.length\"\r\n              :data=\"form.user_list\"\r\n              class=\"le-users-table\"\r\n              max-height=\"368px\"\r\n              row-class-name=\"le-table-row\"\r\n            >\r\n              <el-table-column\r\n                label=\"用户ID\"\r\n                width=\"120\"\r\n                prop=\"id\"\r\n              ></el-table-column>\r\n              <el-table-column label=\"用户昵称\" prop=\"nickname\">\r\n                <template slot-scope=\"scope\">\r\n                  <he-icon\r\n                    size=\"18px\"\r\n                    v-if=\"scope.row.oauth.type === 'weapp'\"\r\n                    type=\"le-icon-xiaochengxu\"\r\n                  ></he-icon>\r\n                  <he-icon\r\n                    size=\"18px\"\r\n                    v-else-if=\"scope.row.oauth.type === 'wechat'\"\r\n                    type=\"le-icon-wehcat\"\r\n                  ></he-icon>\r\n                  {{ scope.row.nickname }}\r\n                </template>\r\n              </el-table-column>\r\n              <el-table-column label=\"操作\" width=\"160\">\r\n                <template slot-scope=\"scope\">\r\n                  <span\r\n                    class=\"le-button-text\"\r\n                    @click=\"form.user_list.splice(scope.$index, 1)\"\r\n                    >移除</span\r\n                  >\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <span slot=\"label\" class=\"le-form-item__label\"\r\n              >指定用户标签发放</span\r\n            >\r\n            <el-button\r\n              class=\"le-btn\"\r\n              action=\"setLabel\"\r\n              module=\"users\"\r\n              title=\"选择用户标签\"\r\n              width=\"704\"\r\n              v-popup.chooseLabel=\"{ label: form.label_list }\"\r\n              >选择用户标签\r\n            </el-button>\r\n            <div class=\"le-user-label flex flex-wrap\">\r\n              <div\r\n                class=\"le-tag\"\r\n                v-for=\"(item, index) in form.label_list\"\r\n                :key=\"index\"\r\n              >\r\n                <span>{{ item.name }}</span>\r\n                <i\r\n                  class=\"el-tag__close el-icon-close\"\r\n                  @click.stop=\"delLabel(item, index)\"\r\n                ></i>\r\n              </div>\r\n            </div>\r\n          </el-form-item>\r\n        </div>\r\n      </div>\r\n    </el-form>\r\n    <div class=\"le-cardpin\" v-if=\"!disable\">\r\n      <el-button\r\n        type=\"primary\"\r\n        :disabled=\"loading\"\r\n        :loading=\"loading\"\r\n        @click=\"submit()\"\r\n        >提交</el-button\r\n      >\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"send\",\r\n  data() {\r\n    return {\r\n      loading: true,\r\n      disable: false,\r\n      form: {\r\n        num: 1,\r\n        user_list: [],\r\n        label_list: [],\r\n        coupon_list: [\r\n          {\r\n            num: 1,\r\n            id: parseInt(this.$route.query.id),\r\n          },\r\n        ],\r\n      },\r\n      detail: {\r\n        name: \"优惠券名称\",\r\n        over_num: 1,\r\n        begin_time: null,\r\n        give_limit: null,\r\n        sub_price: 0,\r\n      },\r\n      rules: {\r\n        \"coupon_list[0].num\": [\r\n          {\r\n            required: true,\r\n            message: \"请输入每人发放张数\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    router: function (path) {\r\n      this.$router.replace({\r\n        path: path,\r\n      });\r\n    },\r\n    chooseUser: function (e) {\r\n      this.form.user_list = e.item;\r\n    },\r\n    setLabel: function (data) {\r\n      this.form.label_list = data.label;\r\n    },\r\n    delLabel: function (item, index) {\r\n      this.$delete(this.form.label_list, index);\r\n    },\r\n    submit: function () {\r\n      let _this = this;\r\n      _this.loading = true;\r\n      _this.$refs[\"form\"].validate((valid) => {\r\n        if (valid) {\r\n          let form = JSON.parse(JSON.stringify(_this.form));\r\n          form.label_list = form.label_list.map(function (item) {\r\n            return item.id;\r\n          });\r\n          form.user_list = form.user_list.map(function (item) {\r\n            return item.id;\r\n          });\r\n          _this.$heshop\r\n            .coupon(\r\n              \"post\",\r\n              {\r\n                behavior: \"send\",\r\n              },\r\n              form\r\n            )\r\n            .then(function (response) {\r\n              setTimeout(function () {\r\n                _this.detail.over_num =\r\n                  _this.detail.over_num - response[0].length;\r\n                _this.$message.success(\"发放成功\");\r\n                _this.loading = false;\r\n              }, 3000);\r\n            })\r\n            .catch(function (error) {\r\n              _this.loading = false;\r\n              if (error.status === 403) {\r\n                const h = _this.$createElement;\r\n                let arr = error.data.message.split(\"---------\");\r\n                console.log(arr.length);\r\n                let str = \"\";\r\n                if (arr.length > 1) {\r\n                  str = arr[1];\r\n                } else {\r\n                  str = arr[0];\r\n                }\r\n                _this.$confirm(\"提示\", {\r\n                  confirmButtonText: \"我知道了\",\r\n                  showCancelButton: false,\r\n                  message: h(\"div\", null, [\r\n                    h(\r\n                      \"p\",\r\n                      {\r\n                        class: \"le-text-algin le-confirm-line\",\r\n                      },\r\n                      [\r\n                        h(\"span\", {\r\n                          class: \"el-icon-warning le-warning-icon\",\r\n                        }),\r\n                        h(\r\n                          \"span\",\r\n                          {\r\n                            class: \"le-confirm-title\",\r\n                          },\r\n                          \"发放失败\"\r\n                        ),\r\n                      ]\r\n                    ),\r\n                    h(\r\n                      \"p\",\r\n                      {\r\n                        class: \"le-text-algin le-confirm-tip\",\r\n                      },\r\n                      str\r\n                    ),\r\n                  ]),\r\n                });\r\n              } else {\r\n                _this.$message.error(error.data.message);\r\n              }\r\n            });\r\n        } else {\r\n          this.loading = false;\r\n        }\r\n      });\r\n    },\r\n    getDetail: function () {\r\n      let _this = this;\r\n      this.$heshop\r\n        .coupon(\"get\", parseInt(this.$route.query.id))\r\n        .then(function (response) {\r\n          _this.loading = false;\r\n          if (response.status === 0) {\r\n            _this.disable = true;\r\n            _this.$message.error(\"优惠券已下架\");\r\n          } else if (response.status === 2) {\r\n            _this.disable = true;\r\n            _this.$message.error(\"优惠券已失效\");\r\n          }\r\n          _this.detail = response;\r\n        })\r\n        .catch(function (error) {\r\n          _this.loading = false;\r\n          _this.$message.error(error.data.message);\r\n        });\r\n    },\r\n    formatNum: function (e) {\r\n      e.target.value = e.target.value.replace(/[^\\d.]/g, \"\");\r\n      e.target.value = e.target.value.replace(/^0[^\\.]+/g, \"0\");\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getDetail();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import \"./css/send.less\";\r\n</style>","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!./send.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!./send.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./send.vue?vue&type=template&id=28a9073e&scoped=true&\"\nimport script from \"./send.vue?vue&type=script&lang=js&\"\nexport * from \"./send.vue?vue&type=script&lang=js&\"\nimport style0 from \"./send.vue?vue&type=style&index=0&id=28a9073e&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.7@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"28a9073e\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.9.7@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@7.3.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!./send.vue?vue&type=style&index=0&id=28a9073e&scoped=true&lang=scss&\""],"sourceRoot":""}