(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27c07812"],{1586:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"le-matter"},[a("div",{staticClass:"le-header le-card"},[t._m(0),a("div",{staticClass:"le-editor"},[a("button",{staticClass:"le-button le-default",on:{click:t.bulkShipping}},[t._v("批量发货")]),a("input",{ref:"upload",staticStyle:{display:"none"},attrs:{type:"file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,.csv,application/vnd.ms-excel"},on:{change:t.upload}}),a("button",{staticClass:"le-button le-text"},[a("a",{attrs:{href:t.origin+"/static/files/bulk-shipping-template.xlsx",download:"批量发货模板.xlsx"}},[t._v("下载批量发货模板")])])])]),a("div",{staticClass:"le-search le-card"},[a("span",{staticClass:"le-label"},[t._v("发货时间")]),a("el-date-picker",{staticClass:"le-search-date",attrs:{type:"datetime",placeholder:"开始日期"},model:{value:t.time_start,callback:function(e){t.time_start=e},expression:"time_start"}}),a("span",{staticClass:"le-label"},[t._v("至")]),a("el-date-picker",{staticClass:"le-search-date",attrs:{type:"datetime",placeholder:"结束日期"},model:{value:t.time_end,callback:function(e){t.time_end=e},expression:"time_end"}}),a("div",{staticClass:"le-editor"},[a("button",{staticClass:"le-button le-default",on:{click:t.getSearch}},[t._v("筛选")]),a("el-button",{staticStyle:{"margin-left":"10px"},on:{click:t.empty}},[t._v("清空")])],1)],1),a("div",{staticClass:"le-body le-card"},[a("el-table",{staticClass:"le-table",attrs:{"row-class-name":"le-table-row",height:"680",data:t.list}},[a("el-table-column",{attrs:{label:"发货编号"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.handle_sn)+" ")]}}])}),a("el-table-column",{attrs:{label:"发货订单数"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.order_number)+" ")]}}])}),a("el-table-column",{attrs:{label:"成功发货订单数"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.success_number)+" ")]}}])}),a("el-table-column",{attrs:{label:"操作时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeFormat")(e.row.created_time,"yyyy-mm-dd hh:MM:ss"))+" ")]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.order_number!==e.row.success_number?a("button",{staticClass:"le-button le-text",on:{click:function(a){return t.exportData(e.row.id)}}},[t._v("失败记录")]):[t._v(" — — ")]]}}])})],1),a("div",{staticClass:"le-pagination flex justify-end align-center"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper","current-page":t.page.current,"page-count":t.page.count},on:{"current-change":t.currentChange}})],1)],1),a("he-loading",{attrs:{title:"文件上传处理中，请稍后...",show:t.loading}}),a("el-dialog",{attrs:{visible:t.dialogVisible,width:"30%",top:"35vh"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticStyle:{"text-align":"center","margin-top":"43px"}},[a("i",{staticClass:"le-icon le-icon-zhushi"}),a("div",{staticClass:"le-dialog-text"},[t._v(" "+t._s(1===t.dialogType?"文件格式错误，请使用csv、xls、xlsx的格式文件":2===t.dialogType?"文件大小超过2MB，请压缩或删减内容后上传":"订单数据量超过1000条，请删减后分多次上传")+" ")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("重新上传")])],1)])],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"le-announcement"},[t._v(" 批量发货注意事项： "),a("br"),t._v(" 1. 请先按照模板填写订单号、物流公司、物流单号信息。物流单号不可写成E+22的科学计数法"),a("br"),t._v(" 2. 未成功发货的订单，可下载【失败记录】查看详细的失败原因，对症修改"),a("br"),t._v(" 3. 发货订单数据，最大不超过1000条（支持csv、xls、xlsx，文件大小请控制在2MB以内）"),a("br"),t._v(" 4. 物流公司名称，请填写全称，如圆通速递，不可填写为圆通"),a("br")])}],n=(a("d3b7"),a("25f0"),a("b0c0"),a("159b"),a("7d53")),l=a("1146"),o=a.n(l),r={name:"bulkShipping",components:{heLoading:n["a"]},data:function(){return{origin:"",list:[],time_start:"",time_end:"",loading:!1,page:{size:20,current:1,count:1},dialogVisible:!1,dialogType:1}},methods:{currentChange:function(t){this.page.current=t,this.getList()},bulkShipping:function(){this.$refs.upload.click()},getSearch:function(){this.page.current=1,this.getList()},empty:function(){this.time_start="",this.time_end="",this.page.current=1,this.getList()},getList:function(){var t=this,e={};this.time_start&&(e.time_start=new Date(this.time_start).getTime().toString().substr(0,10)),this.time_end&&(e.time_end=new Date(this.time_end).getTime().toString().substr(0,10)),this.$heshop.orderhandle("get",e).page(this.page.current,this.page.size).then((function(e){var a=e.data,i=e.headers;t.list=a,t.page={current:+i["x-pagination-current-page"],count:+i["x-pagination-page-count"],size:+i["x-pagination-per-page"],total:+i["x-pagination-total-count"]}})).catch((function(){t.$message.error("获取失败")}))},upload:function(){var t=this.$refs.upload.files;this.readExcel(t)},readExcel:function(t){var e=this,a=this;if(t.length<=0)return!1;if(!/\.(csv|xls|xlsx)$/.test(t[0].name.toLowerCase()))return this.dialogVisible=!0,this.dialogType=1,!1;if(t[0].size/1024/1024>2)return console.log(t[0].size),this.dialogVisible=!0,this.dialogType=2,!1;this.loading=!0;var i=new FileReader;i.onload=function(t){try{var i=t.target.result,s=o.a.read(i,{type:"binary"}),n=s.SheetNames[0],l=o.a.utils.sheet_to_json(s.Sheets[n]),r=[];if(r.length>1e3)return e.dialogVisible=!0,e.dialogType=3,!1;l.forEach((function(t){var e,a,i;r.push([null!==(e=t["订单号"])&&void 0!==e?e:"",null!==(a=t["物流公司"])&&void 0!==a?a:"",null!==(i=t["物流单号"])&&void 0!==i?i:""])})),a.$heshop.orderhandle("post",r).then((function(){a.$message.success("操作成功"),a.loading=!1,a.getList()})).catch((function(t){console.error(t),a.loading=!1,a.$message.error(t.data.message)})),a.$refs.upload.value=""}catch(c){a.loading=!1,a.$message.error("系统错误")}},i.readAsBinaryString(t[0])},exportData:function(t){var e=this;this.loading=!0,this.$heshop.orderhandle("get",t).then((function(t){var i=["订单号","物流公司","物流单号","失败描述"],s=t.error_data;Promise.resolve().then(function(){e.$h.Export2Excel.export_json_to_excel({header:i,data:s,filename:name+"批量发货失败记录("+e.$moment(new Date).format("YYYYMMDDHHmmss")+")"}),e.loading=!1}.bind(null,a)).catch(a.oe)})).catch((function(t){e.loading=!1,e.$message.error(t.data.message)}))}},mounted:function(){this.origin=window.location.origin,this.getList()}},c=r,u=(a("f03a"),a("2877")),d=Object(u["a"])(c,i,s,!1,null,"01e9b25f",null);e["default"]=d.exports},"6b62":function(t,e,a){},f03a:function(t,e,a){"use strict";a("6b62")}}]);