(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["promoter/promoter-index-detail-list"],{"0c76":function(e,t,i){"use strict";i.r(t);var r,s,a,o,l=i("4c02"),n=i.n(l),c=(i("61d9"),i("877e"),i("e939"),i("2e9c"),i("049f"),i("d36b"),i("8236")),u=i("2573"),d=i("9d6b"),h=i("1696"),m=(i("e186"),i("da02"),i("d014"),i("0e28")),f={name:"dissolve-relationship",data:function(){return{form:{radio:0,transfer_id:""},list:[],loading:!1,showItem:null}},props:{value:{type:Boolean,default:!1},info:{type:[Object]}},computed:{showDialog:{get:function(e){var t=e.value;return t},set:function(e){this.$emit("input",e)}}},render:function(){var e=this,t=arguments[0],i=this;return t("el-dialog",n()([{attrs:{visible:i.showDialog,title:"确认解除关系",width:"496px"}},{on:Object(h["a"])({},"update:visible",(function(e){i.showDialog=e}))}]),[t("el-form",{attrs:{"label-width":"129px"},class:"le-form"},[t("el-form-item",{attrs:{label:"解除关系的处理"}},[t("el-radio-group",{model:{value:i.form.radio,callback:function(t){e.$set(i.form,"radio",t)}}},[t("div",{class:"radio-item"},[t("el-radio",{attrs:{label:0}},["自由绑定分销商"]),t("div",{class:"le-prompt-text"},["      选择后，下线用户将重新自由绑定分销商"])]),t("div",{class:"radio-item"},[t("el-radio",{attrs:{label:1}},["转移给指定分销商"]),t("div",{class:"le-prompt-text"},["      选择后，下线用户将成为新的分销商的一级下线"]),t("el-select",{attrs:{loading:i.loading,filterable:!0,remote:!0,placeholder:"请输入新分销商的手机号搜索",disabled:1!==i.form.radio,"remote-method":i.remoteMethod},on:{change:i.selectMobile},model:{value:i.form.select,callback:function(t){e.$set(i.form,"select",t)}}},[i.list.map((function(e,i){return t("el-option",{key:i,attrs:{label:e.mobile,value:e}})}))])])]),function(){if(i.showItem)return t("div",{class:"show--item"},[i.showItem.show_value])}()])]),t("div",{slot:"footer"},[t("el-button",{on:{click:function(){return i.showDialog=!1}}},["取消"]),t("el-button",{attrs:{type:"primary"},on:{click:i.submit}},["确定"])])])},methods:{remoteMethod:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function i(){var r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(""===e){i.next=7;break}return t.loading=!0,i.next=4,Object(m["K"])({uid:t.info.UID,mobile:e});case 4:r=i.sent,t.list=r.filter((function(t){return t.mobile=t.mobile.toString(),t.mobile.indexOf(e)>-1})),t.loading=!1;case 7:case"end":return i.stop()}}),i)})))()},selectMobile:function(e){this.showItem=e,this.form.transfer_id=e.UID},submit:function(){var e=this;if(1===this.form.radio){if(!this.form.transfer_id)return void this.$message.error("请输入新分销商的手机号搜索")}else this.form.transfer_id=null;Object(m["b"])(this.info.UID,"dispense",this.form).then((function(){e.$emit("confirm"),e.$message.success("解除关系成功"),e.showDialog=!1}))}}},p=f,b=(i("11f8"),i("cba8")),g=Object(b["a"])(p,r,s,!1,null,"54d50fce",null),v=g.exports,w={mixins:[c["a"]],components:{recruitmentPromotion:u["a"],dissolveRelationship:v},data:function(){return{list:[],type:"一级下线",children:{},children_num:0,user:{},form:{page:1,search:"",type:0},page:{size:20,total:0},showDissolveRelationship:!1,dissolveRelationshipInfo:null}},render:function(){var e=this,t=arguments[0],i=this,r=[{label:"全部",value:0},{label:"分销商",value:1},{label:"普通下线",value:2}];return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[t("a",{on:{click:this.routerBack.bind(this,-2)}},["分销列表"])]),t("el-breadcrumb-item",[t("a",{on:{click:this.routerBack.bind(this,-1)}},["分销商详情"])]),t("el-breadcrumb-item",["下线列表"])]),t("div",{class:"le-card le-card-margin le-userinfo-box flex align-center"},[t("div",{class:"le-userinfo flex align-center"},[t("el-avatar",{attrs:{size:48,error:function(){return!0}}},[t("img",{attrs:{src:this.user.avatar}})]),t("span",{class:"le-username"},[this.user.nickname])]),t("span",{class:"le-title"},[this.type]),t("span",{class:"le-number"},[i.children_num])]),t("el-form",n()([{class:"le-card le-card-margin"},{props:{model:i.form}},{attrs:{inline:!0,"label-width":"112px"}}]),[t("el-form-item",{attrs:{label:"下线搜索"}},[t("el-input",{attrs:{placeholder:"输入昵称搜索"},model:{value:i.form.search,callback:function(t){e.$set(i.form,"search",t)}}})]),t("el-form-item",{attrs:{label:"下线类型"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:i.form.type,callback:function(t){e.$set(i.form,"type",t)}}},[r.map((function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})}))])]),t("div",{class:"le-button"},[t("el-button",{attrs:{type:"primary"},on:{click:this.filter}},["筛选"]),t("el-button",{on:{click:this.empty}},["清空"])])]),t("div",{class:"le-card le-card-margin le-table"},[t("el-table",n()([{},{props:{data:this.list}},{attrs:{"row-class-name":"le-table-row"}}]),[t("el-table-column",{attrs:{label:"用户","min-width":"200px"},scopedSlots:{default:function(e){return t("div",{class:"flex align-center"},[t("el-avatar",{attrs:{size:40,error:function(){return!0}}},[t("img",{attrs:{src:e.row.avatar}})]),t("i",{class:"le-icon le-userplatform-icon le-icon-".concat("weapp"===e.row.type?"xiaochengxu":"wehcat")}),t("span",[e.row.nickname])])}}}),t("el-table-column",{attrs:{label:"下级类型","min-width":"100px"},scopedSlots:{default:function(e){return e.row.status&&2==e.row.status?"分销商":"普通下线"}}}),t("el-table-column",{attrs:{label:"分销商等级","min-width":"100px"},scopedSlots:{default:function(e){return e.row.status&&2==e.row.status&&e.row.level_name?e.row.level_name:"--"}}}),t("el-table-column",{attrs:{label:"分销商品金额(元)","min-width":"130px"},scopedSlots:{default:function(e){return e.row.sales_amount}}}),t("el-table-column",{attrs:{label:"贡献佣金金额(元)","min-width":"130px"},scopedSlots:{default:function(e){return e.row.commission}}}),t("el-table-column",{attrs:{label:"成为下线时间","min-width":"150px"},scopedSlots:{default:function(t){return t.row.bind_time?e.$moment(new Date(1e3*t.row.bind_time)).format("Y-MM-DD HH:mm:ss"):"--"}}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:{default:function(r){if(r.row.id!==e.user.UID)return t("el-button",{class:"le-table-button",attrs:{type:"text"},on:{click:i.dissolveRelationship.bind(i,r.row)}},["解除关系"])}}})]),t("div",{class:"flex le-pagination justify-end"},[t("el-pagination",{attrs:{background:!0,"current-page":this.form.page,layout:"prev, pager, next, jumper","page-count":this.page.count},on:{"current-change":this.switchPage}})])]),function(){if(i.showDissolveRelationship)return t(v,{on:{confirm:i.dissolveRelationshipConfirm},attrs:{info:i.dissolveRelationshipInfo},model:{value:i.showDissolveRelationship,callback:function(t){e.$set(i,"showDissolveRelationship",t)}}})}()])},mounted:function(){var e=this.$route.params;"{}"===JSON.stringify(e)?e=JSON.parse(localStorage.getItem("promoter_children")):localStorage.setItem("promoter_children",JSON.stringify(e)),this.type=1==e.type?"一级下线数":2==e.type?"二级下线数":"三级下线数",this.children=1==e.type?e.detail.children.first:2==e.type?e.detail.children.second:e.detail.children.third,e.detail.user["UID"]=e.detail.UID,this.user=e.detail.user,this.children_num=this.children.ordinary+this.children.promoter,this.getList()},methods:{getList:function(){var e=this;this.$heshop.promoter("post",{behavior:"children_list"},{parent:this.children.parent,UID:this.user.UID,nickname:this.form.search.trim(),type:this.form.type}).page(this.form.page,this.page.size).then((function(t){var i=t.data,r=t.headers;e.list=i,e.form.page=+r["x-pagination-current-page"],e.page={count:+r["x-pagination-page-count"],size:+r["x-pagination-per-page"],total:+r["x-pagination-total-count"]}})).catch((function(t){e.$message.error(t.data.message)}))},routerBack:function(e){this.$router.go(e)},filter:function(){this.replaceQuery(),this.getList()},empty:function(){this.form={search:"",type:0,page:1},this.filter()},switchPage:function(e){this.form.page=e,this.replaceQuery(),this.getList()},dissolveRelationship:function(e){this.showDissolveRelationship=!0,this.dissolveRelationshipInfo=e,this.dissolveRelationshipInfo.UID=e.id},dissolveRelationshipConfirm:function(){var e=this,t=this.list.findIndex((function(t){return t.id===e.dissolveRelationshipInfo.id}));this.$delete(this.list,t),this.children_num--}}},x=w,y=(i("41f2"),Object(b["a"])(x,a,o,!1,null,"3b5da6a3",null));t["default"]=y.exports},"11f8":function(e,t,i){"use strict";i("4cb8")},"41f2":function(e,t,i){"use strict";i("5cbf")},"4cb8":function(e,t,i){},"5cbf":function(e,t,i){}}]);