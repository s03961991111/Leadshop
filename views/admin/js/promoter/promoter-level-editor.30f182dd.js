(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["promoter/promoter-level-editor"],{"1ce7":function(e,l,t){"use strict";t("b079")},"717a":function(e,l,t){"use strict";t.r(l);var a,r,n=t("4c02"),i=t.n(n),c=t("99a5"),o=(t("6a61"),t("e1d4"),t("fc2a"),t("a5c9"),t("f5bd"),t("eb62"),t("2070"),t("b12c"),t("2769"),t("0756"),t("0e28")),s={name:"level-editor",data:function(){var e=this,l=/(^[\d]|^[1-9][\d]*)($|[\.][\d]{0,2}$)/,t=function(t,a,r){l.test(a)?(a=Number(a),a>100?r("请输入小于100的数字"):((a<=e.form.second||a<=e.form.third)&&r("一级分销佣金需大于二级分销佣金和三级分销佣金"),r())):r("请输入小数位为两位的数字")},a=function(t,a,r){l.test(a)?(a=Number(a),a>100?r("请输入小于100的数字"):(a<e.form.third&&r("二级分销佣金需大于三级分销佣金"),a>e.form.first&&r("二级分销佣金需小于一级分销佣金"),r())):r("请输入小数位为两位的数字")},r=function(t,a,r){var n=e.$_.cloneDeep(e.levelList).reverse();if(l.test(a))if(a=Number(a),a>100)r("请输入小于100的数字");else{if(a>=Number(e.form.second)&&r("三级分销佣金需小于二级分销佣金"),e.form.level>1){var i=e.form.level,c=n.find((function(e){return e.level<i&&e.first}));if(c){var o=Number(c.first);a<=o&&r("三分销佣金需大于【".concat(c.name,"】的一级分销佣金").concat(o,"%"))}}r()}else r("请输入小数位为两位的数字")},n=function(l,t,a){var r=e.form.condition,n=[];n=Object.keys(r).map((function(e){return{key:e,value:r[e]}}));var i=n.findIndex((function(e){return e.value.checked}));i<0&&a("条件必须选一个");for(var c=0;c<n.length;c++)if(n[c].value.checked&&!n[c].value.num)return void a("值不能为空");a()};return{form:{name:"",level:null,first:"",second:"",third:"",update_type:1,is_auto:1,condition:{all_children:{checked:!1,num:null},total_bonus:{checked:!1,num:null},total_money:{checked:!1,num:null}}},levelList:[],rules:{level:[{required:!0,message:"请选择等级"}],name:[{required:!0,message:"请输入等级名称"}],first:[{required:!0,validator:t,trigger:["blur"]}],second:[{required:!0,validator:a,trigger:["blur"]}],third:[{required:!0,validator:r,trigger:["blur"]}],update_type:[{required:!0,validator:n,trigger:["change"]}]},loading:!0,disabled:!0}},mounted:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function l(){var t,a,r,n;return regeneratorRuntime.wrap((function(l){while(1)switch(l.prev=l.next){case 0:return l.next=2,Object(o["y"])();case 2:if(t=l.sent,e.levelList=t.list,a=e.$route.query.id,!a){l.next=12;break}return e.loading=!0,l.next=9,Object(o["v"])(a);case 9:for(r=l.sent,n=0;n<e.levelList.length;n++)e.levelList[n].disabled=e.levelList[n].level!==r.level;e.form=r;case 12:e.loading=!1,e.disabled=!1;case 14:case"end":return l.stop()}}),l)})))()},methods:{routerBack:function(){this.$router.back()},submit:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function l(){var t;return regeneratorRuntime.wrap((function(l){while(1)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,e.$refs["form"].validate();case 3:if(e.loading=!0,t=e.$route.query.id,t){l.next=10;break}return l.next=8,Object(o["c"])(e.form);case 8:l.next=12;break;case 10:return l.next=12,Object(o["w"])(t,e.form);case 12:e.loading=!1,e.routerBack(),l.next=19;break;case 16:l.prev=16,l.t0=l["catch"](0),e.loading=!1;case 19:case"end":return l.stop()}}),l,null,[[0,16]])})))()},selectionLevel:function(e,l){l.disabled||(this.form.level=e+1,this.form.is_auto=0!==e?1:0)}},render:function(){var e=this,l=arguments[0],t=this;return l("div",{class:"le-main"},[l("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[l("el-breadcrumb-item",[l("a",{on:{click:this.routerBack}},["分销等级"])]),l("el-breadcrumb-item",[t.$route.query.id?"编辑":"添加","分销商等级"])]),l("el-form",i()([{attrs:{"label-width":"193px"},directives:[{name:"loading",value:t.loading}],ref:"form"},{props:{model:t.form,rules:t.rules}}]),[l("div",{class:"le-card le-card-margin"},[l("div",{class:"le-card-head flex align-center"},[l("span",{class:"le-card-line"}),l("span",["等级信息"])]),l("div",{class:"le-card-body"},[l("el-form-item",{attrs:{label:"选择等级",prop:"level"}},[l("div",{class:"flex flex-wrap le-level--box"},[t.levelList.map((function(e,a){var r=t.form.level;return l("div",{on:{click:t.selectionLevel.bind(t,a,e)},class:[{active:a+1===r,"le-level--disabled":e.disabled},"le-level--selection"],key:a},[e.name])}))])]),l("el-form-item",{attrs:{label:"等级名称",prop:"name"}},[l("el-input",{class:"le-small--input",attrs:{placeholder:"请输入等级名称",maxlength:"8","show-word-limit":!0},model:{value:t.form.name,callback:function(l){e.$set(t.form,"name",l)}}})])])]),l("div",{class:"le-card le-card-margin"},[l("div",{class:"le-card-head flex align-center"},[l("span",{class:"le-card-line"}),l("span",["等级佣金"])]),l("div",{class:"le-card-body"},[l("el-form-item",{attrs:{label:"一级分销佣金",prop:"first"}},[l("el-input",i()([{class:"le-small--input"},{nativeOn:{input:function(e){e.target.value=e.target.value.replace(/[^\d.]/g,""),e.target.value=e.target.value.replace(/\.{2,}/g,"."),e.target.value=e.target.value.replace(/^\./g,"0."),e.target.value=e.target.value.replace(/^0[^\.]+/g,"0"),e.target.value=e.target.value.replace(".","$#$").replace(/\./g,"").replace("$#$","."),e.target.value=e.target.value.replace(/^(\d+)\.(\d\d).*$/,"$1.$2"),t.form.first=e.target.value}}},{model:{value:t.form.first,callback:function(l){e.$set(t.form,"first",l)}}}]),[l("template",{slot:"append"},["%"])])]),l("el-form-item",{attrs:{label:"二级分销佣金",prop:"second"}},[l("el-input",i()([{class:"le-small--input"},{nativeOn:{input:function(e){e.target.value=e.target.value.replace(/[^\d.]/g,""),e.target.value=e.target.value.replace(/\.{2,}/g,"."),e.target.value=e.target.value.replace(/^\./g,"0."),e.target.value=e.target.value.replace(/^0[^\.]+/g,"0"),e.target.value=e.target.value.replace(".","$#$").replace(/\./g,"").replace("$#$","."),e.target.value=e.target.value.replace(/^(\d+)\.(\d\d).*$/,"$1.$2"),t.form.second=e.target.value}}},{model:{value:t.form.second,callback:function(l){e.$set(t.form,"second",l)}}}]),[l("template",{slot:"append"},["%"])])]),l("el-form-item",{attrs:{label:"三级分销佣金",prop:"third"}},[l("el-input",i()([{class:"le-small--input"},{nativeOn:{input:function(e){e.target.value=e.target.value.replace(/[^\d.]/g,""),e.target.value=e.target.value.replace(/\.{2,}/g,"."),e.target.value=e.target.value.replace(/^\./g,"0."),e.target.value=e.target.value.replace(/^0[^\.]+/g,"0"),e.target.value=e.target.value.replace(".","$#$").replace(/\./g,"").replace("$#$","."),e.target.value=e.target.value.replace(/^(\d+)\.(\d\d).*$/,"$1.$2"),t.form.third=e.target.value}}},{model:{value:t.form.third,callback:function(l){e.$set(t.form,"third",l)}}}]),[l("template",{slot:"append"},["%"])])])])]),l("div",{class:"le-card le-card-margin"},[l("div",{class:"le-card-head flex align-center"},[l("span",{class:"le-card-line"}),l("span",["等级升级"])]),l("div",{class:"le-card-body"},[l("el-form-item",{attrs:{label:"自动升级"}},[l("el-radio-group",{attrs:{disabled:1===t.form.level},model:{value:t.form.is_auto,callback:function(l){e.$set(t.form,"is_auto",l)}}},[l("el-radio",{attrs:{label:1}},["允许自动升级"]),l("el-radio",{attrs:{label:0}},["禁止自动升级"])]),l("div",{class:"le-prompt-text"},["选择允许自动升级后，将在用户的等级中心显示等级的升级条件和佣金比例"])]),function(){if(1!==t.form.level&&1===t.form.is_auto)return l("el-form-item",{attrs:{label:"升级条件",prop:"update_type"}},[l("el-radio-group",{model:{value:t.form.update_type,callback:function(l){e.$set(t.form,"update_type",l)}}},[l("el-radio",{attrs:{label:1}},["满足以下任意条件"]),l("el-radio",{attrs:{label:2}},["满足以下全部条件"])]),l("div",[l("div",{class:"flex",style:"margin-top: 15px"},[l("el-checkbox",{class:"le-condition--item",model:{value:t.form.condition.total_bonus.checked,callback:function(l){e.$set(t.form.condition.total_bonus,"checked",l)}}},[l("div",{class:"flex align-center"},[l("span",{class:"le-label"},["累计佣金"])])]),l("div",[l("el-input",{class:"le-input--200",attrs:{disabled:!t.form.condition.total_bonus.checked},model:{value:t.form.condition.total_bonus.num,callback:function(l){e.$set(t.form.condition.total_bonus,"num",l)}}},[l("template",{slot:"append"},["元"])])])]),l("div",{class:"flex",style:"margin-top: 15px"},[l("el-checkbox",{class:"le-condition--item",model:{value:t.form.condition.all_children.checked,callback:function(l){e.$set(t.form.condition.all_children,"checked",l)}}},[l("div",{class:"flex align-center"},[l("span",{class:"le-label"},["当前下线数"])])]),l("div",[l("el-input",{class:"le-input--200",attrs:{disabled:!t.form.condition.all_children.checked},model:{value:t.form.condition.all_children.num,callback:function(l){e.$set(t.form.condition.all_children,"num",l)}}},[l("template",{slot:"append"},["人"])])])]),l("div",{class:"flex",style:"margin-top: 15px"},[l("el-checkbox",{class:"le-condition--item",model:{value:t.form.condition.total_money.checked,callback:function(l){e.$set(t.form.condition.total_money,"checked",l)}}},[l("div",{class:"flex align-center"},[l("span",{class:"le-label"},["累计销售金额"])])]),l("div",[l("el-input",{class:"le-input--200",attrs:{disabled:!t.form.condition.total_money.checked},model:{value:t.form.condition.total_money.num,callback:function(l){e.$set(t.form.condition.total_money,"num",l)}}},[l("template",{slot:"append"},["元"])])])])])])}()])])]),l("div",{class:"le-cardpin"},[l("el-button",{attrs:{type:"primary",loading:t.loading&&!t.disabled,disabled:t.disabled},on:{click:t.submit}},["保存"])])])}},d=s,u=(t("1ce7"),t("4ac2")),m=Object(u["a"])(d,a,r,!1,null,"64de15c8",null);l["default"]=m.exports},b079:function(e,l,t){}}]);