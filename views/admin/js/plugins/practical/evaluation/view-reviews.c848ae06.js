(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["plugins/practical/evaluation/view-reviews"],{"3edb":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"le-main"},[n("div",{staticClass:"le-card flex"},[n("img",{staticClass:"le-img",attrs:{src:t.good.image,alt:""}}),n("div",{staticClass:"le-name"},[t._v(t._s(t.good.name))])]),n("el-form",{staticClass:"le-card",attrs:{"label-width":"118px",inline:""}},[n("el-form-item",{attrs:{label:"评价来源"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[n("el-option",{attrs:{label:"全部",value:" "}}),n("el-option",{attrs:{label:"评论库抓取",value:"repository"}}),n("el-option",{attrs:{label:"API抓取",value:"api"}})],1)],1),n("el-form-item",{attrs:{label:"评价状态"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[n("el-option",{attrs:{label:"全部",value:" "}}),n("el-option",{attrs:{label:"显示",value:"display"}}),n("el-option",{attrs:{label:"隐藏",value:"hidden"}}),n("el-option",{attrs:{label:"置顶",value:"top"}})],1)],1),n("div",{staticStyle:{"margin-left":"50px"}},[n("el-button",{attrs:{type:"primary"},on:{click:t.getList}},[t._v("筛选")]),n("el-button",{on:{click:t.empty}},[t._v("清空")])],1)],1),n("div",{staticClass:"le-card"},[n("div",{staticClass:"le-batch"},[n("el-checkbox",{attrs:{indeterminate:t.indeterminate},on:{change:t.allCheckEvent},model:{value:t.allCheck,callback:function(e){t.allCheck=e},expression:"allCheck"}},[t._v("当页全选 ")]),n("el-button",{attrs:{disabled:0===t.selected.length},on:{click:function(e){return t.batchEdit(2)}}},[t._v("批量置顶")]),n("el-button",{attrs:{disabled:0===t.selected.length},on:{click:function(e){return t.batchEdit(1)}}},[t._v("批量显示")]),n("el-button",{attrs:{disabled:0===t.selected.length},on:{click:function(e){return t.batchEdit(0)}}},[t._v("批量隐藏")]),n("el-button",{attrs:{disabled:0===t.selected.length},on:{click:function(e){return t.batchDel()}}},[t._v("批量删除")])],1),n("el-table",{ref:"goodsTable",staticClass:"le-table",attrs:{data:t.list,"cell-class-name":"le-cell-table"},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection"}}),n("el-table-column",{attrs:{label:"评价等级"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v(t._s(e.row.star>=4?"好评":e.row.star>2?"中评":"差评"))]),n("el-rate",{attrs:{colors:t.colors,"low-threshold":2,disabled:""},model:{value:e.row.star,callback:function(n){t.$set(e.row,"star",n)},expression:"scope.row.star"}})]}}])}),n("el-table-column",{attrs:{label:"评价内容",width:"312px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v(t._s(e.row.content))]),n("div",{staticClass:"flex flex-wrap"},t._l(e.row.images,(function(t,a){return n("el-image",{key:a,staticClass:"le-image",attrs:{"preview-src-list":e.row.images,src:t}})})),1)]}}])}),n("el-table-column",{attrs:{label:"用户信息",prop:"ai_nickname"}}),n("el-table-column",{attrs:{label:"商品规格",prop:"show_goods_param"}}),n("el-table-column",{attrs:{label:"评价时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.$moment(1e3*e.row.created_time).format("YYYY-MM-DD hh:mm:ss"))+" ")]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[2!==e.row.status?n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.editStatus(e.row,2)}}},[t._v("置顶 ")]):n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.editStatus(e.row,1)}}},[t._v("取消置顶 ")]),n("span",{staticClass:"le-line"},[t._v("|")]),0!==e.row.status?n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.editStatus(e.row,0)}}},[t._v("隐藏 ")]):n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.editStatus(e.row,1)}}},[t._v("显示 ")]),n("span",{staticClass:"le-line"},[t._v("|")]),n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.del(e.row,e.$index)}}},[t._v("删除")])]}}])})],1),n("div",{staticClass:"flex justify-between le-footer"},[n("div",{staticClass:"le-batch"},[n("el-checkbox",{attrs:{indeterminate:t.indeterminate},on:{change:t.allCheckEvent},model:{value:t.allCheck,callback:function(e){t.allCheck=e},expression:"allCheck"}},[t._v("当页全选 ")]),n("el-button",{attrs:{disabled:0===t.selected.length},on:{click:function(e){return t.batchEdit(2)}}},[t._v("批量置顶")]),n("el-button",{attrs:{disabled:0===t.selected.length},on:{click:function(e){return t.batchEdit(1)}}},[t._v("批量显示")]),n("el-button",{attrs:{disabled:0===t.selected.length},on:{click:function(e){return t.batchEdit(0)}}},[t._v("批量隐藏")]),n("el-button",{attrs:{disabled:0===t.selected.length},on:{click:function(e){return t.batchDel()}}},[t._v("批量删除")])],1),n("el-pagination",{attrs:{layout:"prev, pager, next, jumper",background:"","pager-count":5,"current-page":t.pagination.current,"page-count":t.pagination.count},on:{"current-change":t.getList,"update:currentPage":function(e){return t.$set(t.pagination,"current",e)},"update:current-page":function(e){return t.$set(t.pagination,"current",e)}}})],1)],1)],1)},l=[],s=(n("f667"),n("e939"),{name:"view-reviews",data:function(){return{colors:["#99A9BF","#F7BA2A","#FF9900"],good:{image:""},list:[],status:" ",type:" ",pagination:{current:1,count:1},selected:[],allCheck:!1,indeterminate:!1}},mounted:function(){try{this.good=JSON.parse(decodeURIComponent(this.$route.query.good)),this.type=this.$route.query.type,this.getList()}catch(t){this.$router.back()}},methods:{getList:function(){var t=this;this.$heshop.plugin("get",{include:"evaluate",model:"evaluate",status:this.status,type:this.type,goods_id:this.good.id}).page(this.pagination.current,10).then((function(e){var n=e.headers,a=e.data;t.list=a,t.pagination={current:+n["x-pagination-current-page"],count:+n["x-pagination-page-count"]}}))},editStatus:function(t,e){var n=this,a="";2===e?a="确认置顶该评价？":0===e?a="确认隐藏该评价？":1===e&&(2===t.status?a="确认取消置顶该评价？":0===t.status&&(a="确认显示该评价？")),this.$confirm(a,{confirmButtonText:"确定",cancelButtonText:"取消",center:!0}).then((function(){n.$heshop.plugin("put",{include:"evaluate",model:"evaluate",ids:[t.id]},{status:e}).then((function(){var a="";2===e?a="置顶成功":0===e?a="隐藏成功":1===e&&(2===t.status?a="取消置顶成功":0===t.status&&(a="显示成功")),t.status=e,n.$message({type:"success",message:a})}))}))},del:function(t,e){var n=this;this.$confirm("确认删除该评价？",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0}).then((function(){n.$heshop.plugin("delete",[t.id],{include:"evaluate",model:"evaluate",behavior:"evaluate",ids:[t.id]}).then((function(){n.$delete(n.list,e),n.$message({type:"success",message:"删除成功"})}))}))},empty:function(){this.status=" ",this.type=" ",this.getList()},handleSelectionChange:function(t){this.selected=t,this.allCheck=this.selected.length===this.list.length,this.indeterminate=this.selected.length>0&&this.selected.length<this.list.length},allCheckEvent:function(){var t=this;this.allCheck?this.list.forEach((function(e){t.$refs.goodsTable.toggleRowSelection(e,!0)})):this.$refs.goodsTable.clearSelection()},batchEdit:function(t){var e=this,n="";2===t?n="确认批量置顶选中评价？":0===t?n="确认批量隐藏该评价？":1===t&&(n="确认批量显示该评价？"),this.$confirm(n,{confirmButtonText:"确定",cancelButtonText:"取消",center:!0}).then((function(){var n=e.selected.map((function(t){return t.id}));e.$heshop.plugin("put",{include:"evaluate",model:"evaluate",ids:n},{status:t}).then((function(){var n="";2===t?n="批量置顶成功":0===t?n="批量隐藏成功":1===t&&(n="批量显示成功"),e.selected.forEach((function(e){e.status=t})),e.$message({type:"success",message:n})}))}))},batchDel:function(){var t=this;this.$confirm("确认批量删除选中评价？",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0}).then((function(){var e=t.selected.map((function(t){return t.id}));t.$heshop.plugin("delete",e,{include:"evaluate",model:"evaluate",behavior:"evaluate",ids:e}).then((function(){t.$message({type:"success",message:"批量删除成功"}),t.getList()}))}))}}}),i=s,c=(n("8f45"),n("cba8")),o=Object(c["a"])(i,a,l,!1,null,"21d7f22c",null);e["default"]=o.exports},"8f45":function(t,e,n){"use strict";n("bbfd")},bbfd:function(t,e,n){}}]);