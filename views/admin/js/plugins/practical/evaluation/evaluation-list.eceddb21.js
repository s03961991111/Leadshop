(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["plugins/practical/evaluation/evaluation-list"],{2167:function(t,e,a){"use strict";a("bbc4")},"2fdd":function(t,e,a){},bbc4:function(t,e,a){},be35:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"le-marin"},[a("div",{staticClass:"le-card"},[a("div",{staticClass:"le-title"},[t._v("评价库名称："+t._s(t.$route.query.name))])]),a("el-button",{attrs:{type:"primary"},on:{click:t.routerGo}},[t._v("添加评价")]),a("div",{staticClass:"le-card"},[a("el-table",{attrs:{data:t.list,"cell-class-name":"le-cell-table"}},[a("el-table-column",{attrs:{prop:"star",label:"评价等级"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.star>=4?"好评":e.row.star>2?"中评":"差评"))]),a("el-rate",{attrs:{colors:t.colors,"low-threshold":2,disabled:""},model:{value:e.row.star,callback:function(a){t.$set(e.row,"star",a)},expression:"scope.row.star"}})]}}])}),a("el-table-column",{attrs:{prop:"content",label:"评价内容"}}),a("el-table-column",{attrs:{prop:"images",label:"图片"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{staticClass:"flex flex-wrap"},t._l(e.row.images,(function(t,o){return a("el-image",{key:o,staticClass:"le-img",attrs:{"preview-src-list":e.row.images,src:t}})})),1)}}])}),a("el-table-column",{attrs:{prop:"name",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.edit(e.row)}}},[t._v("编辑")]),a("span",{staticClass:"le-line"},[t._v("|")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.del(e.row,e.$index)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"flex justify-end le-pagination"},[a("el-pagination",{attrs:{layout:"prev, pager, next, jumper",background:"","page-size":5,"current-page":t.pagination.current,"page-count":t.pagination.count},on:{"current-change":t.getList,"update:currentPage":function(e){return t.$set(t.pagination,"current",e)},"update:current-page":function(e){return t.$set(t.pagination,"current",e)}}})],1)],1),a("edit-evaluation",{attrs:{info:t.editEvaluationInfo},model:{value:t.showEditEvaluation,callback:function(e){t.showEditEvaluation=e},expression:"showEditEvaluation"}})],1)},i=[],s=(a("5d63"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.showDialog,title:"编辑评价",width:"568px",top:"10vh","modal-append-to-body":!0},on:{"update:visible":function(e){t.showDialog=e}}},[a("el-form",{ref:"form",attrs:{"label-width":"88px",model:t.form,rules:t.rules}},[a("el-form-item",{attrs:{label:"评价等级",prop:"star"}},[a("el-rate",{staticStyle:{"line-height":"42px"},attrs:{colors:t.colors},model:{value:t.form.star,callback:function(e){t.$set(t.form,"star",e)},expression:"form.star"}})],1),a("el-form-item",{attrs:{label:"评价内容",prop:"content"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"最少输入10个字，最多输入300个字",maxlength:300,resize:"none",rows:13,"show-word-limit":"",type:"textarea"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),a("el-form-item",{attrs:{label:"图片"}},[a("vuedraggable",{model:{value:t.form.images,callback:function(e){t.$set(t.form,"images",e)},expression:"form.images"}},t._l(t.form.images,(function(e,o){return a("div",{key:o,staticClass:"le-label__require-item",class:{"le-label__require-image":0===o}},[a("div",{staticClass:"select-cover__120"},[a("pictureDialog",{attrs:{limit:1},scopedSlots:t._u([{key:"preview",fn:function(e){return a("div",{staticClass:"select-cover__120-edit"},[a("el-image",{attrs:{src:e.url,fit:"cover"}}),a("div",{staticClass:"select-cover__120-tips"},[a("span",[t._v("替换")]),t._v(" | "),a("span",{on:{click:function(e){return e.stopPropagation(),function(){t.form.images.splice(o,1)}.apply(null,arguments)}}},[t._v("删除")])])],1)}}],null,!0),model:{value:t.form.images[o],callback:function(e){t.$set(t.form.images,o,e)},expression:"form.images[index]"}},[a("div",{staticClass:"select-cover__120-add",attrs:{slot:"upload"},slot:"upload"},[a("i",{staticClass:"le-icon le-icon-add select-cover__120-icon"}),a("span",{staticClass:"select-cover__120-text"},[t._v("添加图片")])])])],1)])})),0),t.form.images.length<6?a("div",{staticClass:"le-label__require-item"},[a("div",{staticClass:"select-cover__120"},[a("pictureDialog",{attrs:{limit:6-t.form.images.length,max:9},on:{confirm:function(e){return t.arrayConcat(e)}},scopedSlots:t._u([{key:"preview",fn:function(e){return a("div",{staticClass:"select-cover__120-add"},[a("i",{staticClass:"le-icon le-icon-add select-cover__120-icon"}),a("span",{staticClass:"select-cover__120-text"},[t._v("添加图片")])])}}],null,!1,2764396145)},[a("div",{staticClass:"select-cover__120-add",attrs:{slot:"upload"},slot:"upload"},[a("i",{staticClass:"le-icon le-icon-add select-cover__120-icon"}),a("span",{staticClass:"select-cover__120-text"},[t._v("添加图片")])])])],1)]):t._e()],1)],1),a("div",{staticClass:"le-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.showDialog=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v(" 确定 ")])],1)],1)}),n=[],r=a("f2b6"),l=a("3335"),c=a.n(l),u={name:"edit-evaluation",components:{vuedraggable:c.a},props:{value:{type:Boolean},info:{type:Object,default:function(){return{}}}},data:function(){return{form:{star:0,images:[]},rules:{star:[{required:!0,message:"等级不能为空",trigger:"blur"}],content:[{required:!0,message:"评价内容不能为空"},{min:10,max:300,message:"长度在 10 到 300 个字符",trigger:"blur"}]},colors:["#99A9BF","#F7BA2A","#FF9900"]}},computed:{showDialog:{get:function(t){var e=t.value;return e},set:function(t){this.$emit("input",t)}}},methods:{arrayConcat:function(t){var e;(e=this.form.images).push.apply(e,Object(r["a"])(t))},submit:function(){var t=this;this.$refs["form"].validate((function(e){e&&t.$heshop.plugin("put",{include:"evaluate",model:"repository",behavior:"evaluate"},{content:t.form.content,id:t.form.id,star:t.form.star,images:t.form.images}).then((function(){t.info.images=t.form.images,t.info.star=t.form.star,t.info.content=t.form.content,t.showDialog=!1,t.$message({type:"success",message:"编辑评价成功"})}))}))}},watch:{value:{handler:function(t){t&&(this.form=this.$_.cloneDeep(this.info))}}}},d=u,p=(a("2167"),a("cba8")),f=Object(p["a"])(d,s,n,!1,null,"98e44b8a",null),m=f.exports,v={name:"evaluation-list",components:{EditEvaluation:m},data:function(){return{list:[],colors:["#99A9BF","#F7BA2A","#FF9900"],showEditEvaluation:!1,editEvaluationInfo:{images:[],star:0},pagination:{current:1,count:1}}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.$heshop.plugin("get",{include:"evaluate",model:"repository",repository_id:this.$route.query.id}).page(this.pagination.current,10).then((function(e){var a=e.headers,o=e.data;t.list=o,t.pagination={current:+a["x-pagination-current-page"],count:+a["x-pagination-page-count"]}}))},routerGo:function(){this.$router.push({path:"/practical/evaluation/add-evaluation",query:{id:this.$route.query.id,name:this.$route.query.name}})},edit:function(t){this.showEditEvaluation=!0,this.editEvaluationInfo=t},del:function(t,e){var a=this;this.$confirm("删除评价请谨慎操作，确定删除？",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0}).then((function(){a.$heshop.plugin("delete",t.id,{include:"evaluate",model:"repository",behavior:"evaluate"}).then((function(){a.$delete(a.list,e),a.$message({type:"success",message:"删除评价成功"}),a.pagination.current<a.pagination.count&&a.getList()}))})).catch((function(){}))}}},g=v,h=(a("e30e"),Object(p["a"])(g,o,i,!1,null,"07b98cd7",null));e["default"]=h.exports},e30e:function(t,e,a){"use strict";a("2fdd")}}]);