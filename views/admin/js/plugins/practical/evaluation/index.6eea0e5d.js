(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["plugins/practical/evaluation/index"],{"2a3e":function(t,e,n){},"2cdf":function(t,e,n){"use strict";n("2a3e")},8614:function(t,e,n){"use strict";n("c2f9")},"9d58":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"le-main"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showChooseGoods=!0}}},[t._v("选择商品添加评价")]),n("el-form",{staticClass:"le-card",attrs:{"label-width":"112px",inline:""}},[n("el-form-item",{attrs:{label:"商品搜索"}},[n("el-input",{attrs:{placeholder:"输入商品名称搜索",clearable:""},on:{clear:t.getList},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList.apply(null,arguments)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),n("el-form-item",{attrs:{label:"商品状态"}},[n("el-select",{model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[n("el-option",{attrs:{label:"全部",value:" "}}),n("el-option",{attrs:{label:"销售中",value:"onsale"}}),n("el-option",{attrs:{label:"下架中",value:"nosale"}}),n("el-option",{attrs:{label:"售罄",value:"soldout"}})],1)],1),n("div",{staticStyle:{"margin-left":"112px"}},[n("el-button",{attrs:{type:"primary"},on:{click:t.getList}},[t._v("筛选")]),n("el-button",{on:{click:t.empty}},[t._v("清空")])],1)],1),n("div",{staticClass:"le-card"},[n("el-table",{attrs:{data:t.list,"cell-class-name":"le-cell-table","default-sort":{prop:"created_time",order:"descending"}},on:{"sort-change":t.sortChange}},[n("el-table-column",{attrs:{"min-width":"312px",label:"商品"},scopedSlots:t._u([{key:"default",fn:function(e){return n("div",{staticClass:"flex align-center"},[n("el-image",{staticClass:"le-image",attrs:{src:e.row.slideshow[0]}}),n("div",{staticClass:"flex-sub",staticStyle:{"margin-left":"12px"}},[n("div",{staticClass:"le-name he-line-2"},[t._v(t._s(e.row.name))]),n("div",{staticClass:"le-assist-text"},[t._v("货号："+t._s(e.row.goods_sn?e.row.goods_sn:"--"))]),n("div",{staticClass:"le-assist-text"},[t._v("ID："+t._s(e.row.goods_id))])])],1)}}])}),n("el-table-column",{attrs:{label:"商品状态","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.stocks>0?[1==e.row.is_sale?n("el-tag",{attrs:{size:"medium",type:"success"}},[t._v("销售中")]):0==e.row.is_sale?n("el-tag",{attrs:{size:"medium",type:"info"}},[t._v("下架中")]):t._e()]:n("el-tag",{attrs:{size:"medium",type:"warning"}},[t._v("售罄")])]}}])}),n("el-table-column",{attrs:{label:"总评价数","render-header":t.hintRender,"min-width":"100px",prop:"all_evaluate_count"}}),n("el-table-column",{attrs:{label:"评价库抓取数","min-width":"120px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.repository_num?[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.viewReviews(e.row,"repository")}}},[t._v(t._s(e.row.repository_num))])]:[t._v(" -- ")]]}}])}),n("el-table-column",{attrs:{label:"API抓取数","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.api_num?[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.viewReviews(e.row,"api")}}},[t._v(t._s(e.row.api_num))])]:[t._v(" -- ")]]}}])}),n("el-table-column",{attrs:{label:"创建时间",sortable:"",prop:"created_time",width:"200px","sort-orders":["ascending","descending"]},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.$moment(1e3*e.row.created_time).format("YYYY-MM-DD hh:mm:ss"))+" ")]}}])}),n("el-table-column",{attrs:{label:"操作",width:"280px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.libraryGrab(e.row)}}},[t._v("评价库抓取")]),n("span",{staticClass:"le-line"},[t._v("|")]),n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.apiGrab(e.row)}}},[t._v("API抓取")]),n("span",{staticClass:"le-line"},[t._v("|")]),n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.viewReviews(e.row)}}},[t._v("查看评价")])]}}])})],1),n("div",{staticClass:"flex justify-end le-pagination"},[n("el-pagination",{attrs:{layout:"prev, pager, next, jumper",background:"","page-size":5,"current-page":t.pagination.current,"page-count":t.pagination.count},on:{"current-change":t.getList,"update:currentPage":function(e){return t.$set(t.pagination,"current",e)},"update:current-page":function(e){return t.$set(t.pagination,"current",e)}}})],1)],1),t.showChooseGoods?n("choose-goods",{on:{confirm:t.getList},model:{value:t.showChooseGoods,callback:function(e){t.showChooseGoods=e},expression:"showChooseGoods"}}):t._e()],1)},o=[],i=(n("dc87"),n("5d63"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{visible:t.showDialog,title:"选择商品添加评价",width:"759px",top:"10vh","modal-append-to-body":!0},on:{"update:visible":function(e){t.showDialog=e}}},[n("el-input",{staticClass:"le-input--380",attrs:{clearable:"",placeholder:"请输入商品名称搜索"},on:{clear:t.getList},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList.apply(null,arguments)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getList},slot:"append"})],1),n("el-table",{attrs:{width:"680px",height:"408px","row-key":"id",data:t.list,"cell-class-name":"le-cell-table"},on:{"selection-change":t.selectionChange}},[n("el-table-column",{attrs:{type:"selection",selectable:t.selecttable,"reserve-selection":!0,width:"55"}}),n("el-table-column",{attrs:{label:"商品"},scopedSlots:t._u([{key:"default",fn:function(e){return n("div",{staticClass:"flex align-center"},[n("el-image",{staticClass:"le-image",attrs:{src:t._f("imageFilter")(e.row.slideshow)}}),n("span",{staticClass:"flex-sub le-name"},[t._v(t._s(e.row.name))])],1)}}])}),n("el-table-column",{attrs:{width:"200px",label:"商品价格"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"le-price"},[t._v("￥"+t._s(e.row.price))])]}}])})],1),n("div",{staticClass:"flex justify-end le-pagination"},[n("el-pagination",{attrs:{layout:"prev, pager, next, jumper",background:"","page-size":5,"current-page":t.pagination.current,"page-count":t.pagination.count},on:{"current-change":t.getList,"update:currentPage":function(e){return t.$set(t.pagination,"current",e)},"update:current-page":function(e){return t.$set(t.pagination,"current",e)}}})],1),n("div",{staticClass:"le-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.showDialog=!1}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v(" 确定")])],1)],1)}),s=[],r=n("9d6b"),l=(n("e186"),n("e939"),n("61d9"),n("877e"),n("d36b"),{name:"choose-goods",props:{value:{type:Boolean},info:{type:Object,default:function(){return{}}}},data:function(){return{list:[],pagination:{current:1,count:1},selectList:[],select:[],search:""}},computed:{showDialog:{get:function(t){var e=t.value;return e},set:function(t){this.$emit("input",t)}}},methods:{submit:function(){var t=this,e=this.selectList.map((function(t){return{goods_id:t.id}}));this.$heshop.plugin("post",{include:"evaluate",model:"goods"},{form:e}).then((function(){t.showDialog=!1,t.$emit("confirm")}))},getList:function(){var t=this;this.list=[],this.$heshop.search("post",{include:"goods"},{keyword:{search:this.search}}).page(this.pagination.current,5).then((function(e){var n=e.headers,a=e.data;t.list=a,t.pagination={current:+n["x-pagination-current-page"],count:+n["x-pagination-page-count"]}})).catch((function(){}))},selectionChange:function(t){this.selectList=t},getSelect:function(){var t=this;this.$heshop.plugin("get",{include:"evaluate",model:"goods",behavior:"goods_list"}).then((function(e){t.select=e}))},selecttable:function(t){var e=this.select.findIndex((function(e){return e===t.id}));return e<=-1}},mounted:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getSelect();case 2:t.getList();case 3:case"end":return e.stop()}}),e)})))()},filters:{imageFilter:function(t){return t[0]}}}),c=l,u=(n("2cdf"),n("cba8")),d=Object(u["a"])(c,i,s,!1,null,"2d656577",null),p=d.exports,g=n("c0b5"),h={name:"index",components:{ChooseGoods:p,HelpHint:g["a"]},data:function(){return{showChooseGoods:!1,list:[],status:" ",keyword:"",pagination:{current:1,count:1},sort:1}},methods:{getList:function(){var t=this;this.$heshop.plugin("get",{include:"evaluate",model:"goods",status:this.status,keyword:this.keyword,sort:this.sort}).page(this.pagination.current,10).then((function(e){var n=e.headers,a=e.data;t.list=a,t.pagination={current:+n["x-pagination-current-page"],count:+n["x-pagination-page-count"]}}))},sortChange:function(t){"ascending"===t.order?this.sort=2:this.sort=1,this.list=[],this.getList()},empty:function(){this.status=" ",this.keyword="",this.getList()},apiGrab:function(t){this.$router.push({path:"/practical/evaluation/api-grab",query:{good:encodeURIComponent(JSON.stringify({image:t.slideshow[0],id:t.id,name:t.name,goods_id:t.goods_id}))}})},viewReviews:function(t,e){this.$router.push({path:"/practical/evaluation/view-reviews",query:{good:encodeURIComponent(JSON.stringify({image:t.slideshow[0],id:t.goods_id,name:t.name})),type:e||null}})},libraryGrab:function(t){this.$router.push({path:"/practical/evaluation/library-grab",query:{good:encodeURIComponent(JSON.stringify({image:t.slideshow[0],id:t.id,name:t.name,goods_id:t.goods_id}))}})},hintRender:function(){return this.$createElement("HelpHint",{props:{content:"总评价数包含真实用户的评价"}},"总评价数")}},mounted:function(){this.getList()}},f=h,m=(n("d5b8"),n("8614"),Object(u["a"])(f,a,o,!1,null,"14598f3e",null));e["default"]=m.exports},c2f9:function(t,e,n){},d2ea:function(t,e,n){},d5b8:function(t,e,n){"use strict";n("d2ea")}}]);