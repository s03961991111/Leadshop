(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["plugins/practical/evaluation/library-grab"],{"5cba":function(e,t,o){},"8ccc":function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=this,o=t.$createElement,s=t._self._c||o;return s("el-form",{ref:"form",staticClass:"le-main",attrs:{"label-width":"190px",model:t.form,rules:t.rules},nativeOn:{submit:function(e){e.preventDefault()}}},[s("div",{staticClass:"le-card flex"},[s("img",{staticClass:"le-img",attrs:{src:t.good.image}}),s("div",[s("div",{staticClass:"le-name"},[t._v(" "+t._s(t.good.name)+" ")]),s("div",{staticClass:"flex align-center",staticStyle:{"margin-left":"20px"}},[t.good.group?s("div",{staticClass:"le-group"},[t._v(t._s(t.good.group))]):t._e(),s("el-button",{staticClass:"le-select-group",attrs:{plain:""},on:{click:function(e){t.showChooseSpecifications=!0}}},[t._v("选择规格")])],1)])]),s("div",{staticClass:"le-card"},[s("div",{staticClass:"le-card--header flex align-center"},[s("span",{staticClass:"le-sign"}),s("span",[t._v("基础信息")])]),s("el-form-item",{attrs:{label:"选择评价库",prop:"repository_id"}},[t.repository?s("el-tag",{attrs:{type:"info",size:"medium",effect:"plain",closable:""},on:{close:function(){e.repository=null,e.form.repository_id=null}}},[t._v(t._s(t.repository.name)+" ")]):t._e(),s("el-button",{attrs:{plain:""},on:{click:function(e){t.showChooseLibrary=!0}}},[t._v("选择评价库")]),t.repository?s("div",{staticClass:"le-count le-prompt-text"},[t._v("共"+t._s(t.repository.count)+"条评价")]):t._e()],1),s("el-form-item",{attrs:{label:"评价数",prop:"num"}},[s("el-input",{staticClass:"le-input--180",model:{value:t.form.num,callback:function(e){t.$set(t.form,"num",t._n(e))},expression:"form.num"}},[s("template",{slot:"append"},[t._v("条")])],2),s("div",{staticClass:"le-prompt-text"},[t._v("建议单次采集不超过50条，否则可能导致采集失败")])],1),s("el-form-item",{attrs:{label:"评价时间范围",prop:"time"}},[s("el-date-picker",{attrs:{type:"datetimerange","value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}})],1),s("el-form-item",{attrs:{label:"评价状态"}},[s("el-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[s("el-radio",{attrs:{label:1}},[t._v("显示")]),s("el-radio",{attrs:{label:0}},[t._v("隐藏")]),s("el-radio",{attrs:{label:2}},[t._v("置顶")])],1)],1)],1),s("div",{staticClass:"le-card"},[s("div",{staticClass:"le-card--header flex align-center"},[s("span",{staticClass:"le-sign"}),s("span",[t._v("用户信息")])]),s("el-form-item",{attrs:{label:"头像来源",prop:"gallery_group_id"}},[t.material?s("el-tag",{attrs:{type:"info",size:"medium",effect:"plain",closable:""},on:{close:function(){e.material=null,e.form.gallery_group_id=null}}},[t._v(t._s(t.material.name)+" ")]):t._e(),s("el-button",{attrs:{plain:""},on:{click:function(e){t.showChooseMaterial=!0}}},[t._v("选择素材组")])],1),s("el-form-item",{attrs:{label:"用户昵称"}},[t._v(" 自动生成虚拟昵称 ")])],1),s("div",{staticClass:"le-cardpin"},[s("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("提交")])],1),s("he-loading",{attrs:{show:t.load,title:"正在抓取中，请稍后..."}}),t.showChooseSpecifications?s("choose-specifications",{attrs:{info:t.good,group:t.good.group},on:{confirm:function(e){return t.good.group=e}},model:{value:t.showChooseSpecifications,callback:function(e){t.showChooseSpecifications=e},expression:"showChooseSpecifications"}}):t._e(),t.showChooseLibrary?s("choose-library",{on:{confirm:function(t){e.repository=t,e.form.repository_id=t.id,e.$refs.form.validateField("repository_id")}},model:{value:t.showChooseLibrary,callback:function(e){t.showChooseLibrary=e},expression:"showChooseLibrary"}}):t._e(),t.showChooseMaterial?s("choose-material",{on:{confirm:function(t){e.material=t,e.form.gallery_group_id=t.id,e.$refs.form.validateField("gallery_group_id")}},model:{value:t.showChooseMaterial,callback:function(e){t.showChooseMaterial=e},expression:"showChooseMaterial"}}):t._e(),s("fetched-success",{attrs:{info:t.fetchedSuccessInfo},on:{confirm:t.empty},model:{value:t.showFetchedSuccess,callback:function(e){t.showFetchedSuccess=e},expression:"showFetchedSuccess"}})],1)},i=[],a=o("4d63"),l=(o("60d6"),o("da02"),o("5d63"),o("7d53")),r=o("5b86"),n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{visible:e.showDialog,title:"选择评价库",width:"432px",top:"20vh"},on:{"update:visible":function(t){e.showDialog=t}}},[o("div",{staticClass:"le-box"},[o("div",{staticClass:"le-box-search"},[o("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"输入评价库名称搜索"},on:{clear:e.getList},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList.apply(null,arguments)}},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getList},slot:"append"})],1)],1),o("el-scrollbar",{staticClass:"le-box-list"},[o("el-radio-group",{staticClass:"le-group",model:{value:e.group,callback:function(t){e.group=t},expression:"group"}},e._l(e.list,(function(t,s){return o("el-radio",{key:s,staticClass:"le-group-item",attrs:{label:t}},[e._v(e._s(t.name)+" ")])})),1)],1)],1),o("div",{staticClass:"le-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v(" 确定")])],1)])},c=[],u={name:"choose-library",props:{value:{type:Boolean},info:{type:Object}},data:function(){return{list:[],group:"",name:""}},computed:{showDialog:{get:function(e){var t=e.value;return t},set:function(e){this.$emit("input",e)}}},methods:{submit:function(){this.$emit("confirm",this.group),this.showDialog=!1},getList:function(){var e=this;this.$heshop.plugin("get",{include:"evaluate",model:"repository",name:this.name}).page(1,30).then((function(t){e.list=t.data}))}},mounted:function(){this.getList()}},d=u,p=(o("f908"),o("cba8")),m=Object(p["a"])(d,n,c,!1,null,"436cc891",null),f=m.exports,h=o("4b46"),g=o("e00f"),b={name:"library-grab",components:{heLoading:l["a"],ChooseSpecifications:r["a"],ChooseLibrary:f,ChooseMaterial:h["a"],fetchedSuccess:g["a"]},data:function(){var e=this,t=function(t,o,s){e.repository&&Number(o)>e.repository.count&&s("评价不能超过评论库的总数"+e.repository.count),isNaN(Number(o))&&s("请输入整数"),Number(o)<0&&s("请输入0以上的整数"),s()};return{good:{image:""},form:{num:0,time:null,status:1,gallery_group_id:null,repository_id:null},rules:{num:[{required:!0,message:"评价数不能为空"},{validator:t,trigger:["blur","change"]}],time:[{required:!0,message:"时间不能为空"}],gallery_group_id:[{required:!0,message:"请选择头像来源"}],repository_id:[{required:!0,message:"请选择评价库"}]},load:!1,showChooseSpecifications:!1,showChooseLibrary:!1,repository:null,showChooseMaterial:!1,material:null,showFetchedSuccess:!1,fetchedSuccessInfo:{}}},mounted:function(){try{this.good=JSON.parse(decodeURIComponent(this.$route.query.good))}catch(e){this.$router.back()}},methods:{submit:function(){var e=this;this.good.group?this.$refs.form.validate((function(t){if(t){e.load=!0;var o=e.$_.cloneDeep(e.form);o.time&&o.time.length>0&&(o.begin=o.time[0]/1e3,o.end=o.time[1]/1e3),e.$heshop.plugin("post",{include:"evaluate",model:"evaluate",behavior:"repository"},Object(a["a"])({id:e.good.id,show_goods_param:e.good.group},o)).then((function(t){e.fetchedSuccessInfo={slideshow:e.good.image,goods_id:e.good.goods_id,name:e.good.name,type:"repository",number:t},e.showFetchedSuccess=!0})).catch((function(t){e.$message({type:"error",message:t.data.message})})).finally((function(){e.load=!1}))}})):this.$message({type:"error",message:"商品规格不能为空"})},empty:function(){this.form={num:0,time:null,status:1,link:"",type:1},this.repository=null,this.material=null,this.good.group=null,console.log(this.$refs.form)}}},v=b,y=(o("8fec"),Object(p["a"])(v,s,i,!1,null,"4f6da088",null));t["default"]=y.exports},"8fec":function(e,t,o){"use strict";o("5cba")},eb0f:function(e,t,o){},f908:function(e,t,o){"use strict";o("eb0f")}}]);