(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["plugins/tools/task/edit"],{a36a:function(t,s,e){},a9f5:function(t,s,e){"use strict";e("a36a")},d6c8:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"task-edit"},[e("div",{staticClass:"task-edit__phone"},[e("div",{staticClass:"task-edit__phone_window"},[t._m(0),e("div",{staticClass:"body"},[e("el-image",{staticStyle:{width:"340px",height:"340px"},attrs:{src:t.covers[0],fit:"fit"}}),e("div",{staticClass:"goods-info"},[e("div",{staticClass:"goods-price"},[e("span",{staticStyle:{"font-size":"22px","font-family":"DINPro","font-weight":"bold",color:"#e60b30"}},[t._v(t._s(t.goodsData.task.task_number))]),e("span",{staticStyle:{"font-size":"11px","font-family":"DINPro","font-weight":"800",color:"#e60b30"}},[t._v(" 积分")]),e("span",{staticStyle:{"font-size":"12px","font-family":"DINPro","font-weight":"bold",color:"#e60b30"}},[t._v(" + ")]),e("span",{staticStyle:{"font-size":"14px","font-weight":"bold",color:"#e60b30"}},[t._v(" ¥")]),e("span",{staticStyle:{"font-size":"22px","font-family":"DINPro","font-weight":"bold",color:"#e60b30"}},[t._v(t._s(t.goodsData.task.task_price))]),e("span",{staticStyle:{"font-size":"11px","font-weight":"500",color:"#999999","text-decoration":"line-through","padding-left":"5px"}},[t._v(t._s(t.goodsData.line_price))])]),e("div",{staticClass:"goods-sales"},[t._v("已销0件")]),t._m(1),e("div",{staticClass:"goods-title"},[t._v(" "+t._s(t.goodsData.name)+" ")])]),t._m(2)],1)])]),e("div",{staticClass:"task-edit__lists task-setting"},[e("el-form",{ref:"form",staticStyle:{width:"100%"},attrs:{model:t.form,"label-width":"100px"}},[e("el-card",{staticClass:"__card"},[e("div",{staticClass:"__card_clearfix",attrs:{slot:"header"},slot:"header"},[e("h3",[t._v("基础信息")])]),e("div",{staticClass:"__card_body",staticStyle:{width:"100%","padding-left":"90px"}},[e("el-form-item",{attrs:{label:"上架状态"}},[e("el-radio-group",{model:{value:t.goodsData.task.goods_is_sale,callback:function(s){t.$set(t.goodsData.task,"goods_is_sale",s)},expression:"goodsData.task.goods_is_sale"}},[e("el-radio",{attrs:{label:1}},[t._v("立即上架")]),e("el-radio",{attrs:{label:0}},[t._v("暂不上架")])],1)],1),e("el-form-item",{attrs:{label:"商品名称"}},[e("el-input",{attrs:{disabled:!0},model:{value:t.goodsData.name,callback:function(s){t.$set(t.goodsData,"name",s)},expression:"goodsData.name"}})],1),e("el-form-item",{attrs:{label:"商品轮播图"}},t._l(t.covers,(function(t,s){return e("div",{key:s,staticClass:"__card_body_img"},[e("img",{attrs:{src:t,alt:""}})])})),0)],1)]),e("el-card",{staticClass:"__card"},[e("div",{staticClass:"__card_clearfix",attrs:{slot:"header"},slot:"header"},[e("h3",[t._v("积分设置")])]),t.goodsData&&1==t.goodsData.param_type&&t.goodsData.task?e("div",{staticClass:"__card_body",staticStyle:{width:"100%","padding-left":"90px"}},[e("el-form-item",{attrs:{label:"可兑换数量","label-width":"120px"}},[e("span",{attrs:{slot:"label"},slot:"label"},[e("strong",{staticStyle:{color:"red","padding-right":"3px"}},[t._v("*")]),t._v("可兑换数量")]),e("el-input",{attrs:{blur:"(e)=>{\n                      if(e.target.value =='') $message.error('可兑换数量不能为空')\n                      if(e.target.value>9999999) $message.error(' 可兑换数量不能大于9999999')\n                  }"},model:{value:t.goodsData.task.task_stock,callback:function(s){t.$set(t.goodsData.task,"task_stock",s)},expression:"goodsData.task.task_stock"}},[e("template",{slot:"append"},[t._v("件")])],2)],1),e("el-form-item",{attrs:{label:"积分价格","label-width":"120px"}},[e("span",{attrs:{slot:"label"},slot:"label"},[e("strong",{staticStyle:{color:"red","padding-right":"3px"}},[t._v("*")]),t._v("积分价格")]),e("el-input",{staticStyle:{width:"140px"},model:{value:t.goodsData.task.task_number,callback:function(s){t.$set(t.goodsData.task,"task_number",s)},expression:"goodsData.task.task_number"}},[e("template",{slot:"append"},[t._v("积分")])],2),t._v(" + "),e("el-input",{staticStyle:{width:"140px"},attrs:{blur:"(e)=>{\n                      if(e.target.value =='') $message.error('积分价格不能为空')\n                      if(!isPriceNumber(e.target.value)) $message.error('积分价格格式不对')\n                      if(e.target.value>9999999) $message.error(' 积分价格不能大于9999999')\n                  }"},model:{value:t.goodsData.task.task_price,callback:function(s){t.$set(t.goodsData.task,"task_price",s)},expression:"goodsData.task.task_price"}},[e("template",{slot:"append"},[t._v("元")])],2)],1),e("el-form-item",{attrs:{label:"兑换限制","label-width":"120px"}},[e("el-input",{model:{value:t.goodsData.task.task_limit,callback:function(s){t.$set(t.goodsData.task,"task_limit",s)},expression:"goodsData.task.task_limit"}},[e("template",{slot:"append"},[t._v("件/人")])],2)],1)],1):t._e(),t.goodsData&&2==t.goodsData.param_type&&t.goodsData.task?e("div",{staticClass:"__card_body",staticStyle:{width:"971px","padding-top":"0"}},[e("TaskSpecstable",{ref:"specstable",attrs:{goods:t.goodsData}})],1):t._e()])],1),e("div",{staticClass:"task-card-footer"},[e("el-button",{on:{click:function(s){return t.$router.go(-1)}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("保存")])],1)],1)])},r=[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"header"},[a("img",{staticClass:"header-bg",attrs:{src:e("2813")}}),a("h3",[t._v("商品详情")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"goods-share"},[e("i",{staticClass:"le-icon le-icon-fenxiang"}),e("p",[t._v("分享")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"goods-pay"},[e("img",{staticClass:"header-bg",attrs:{src:"http://qmxq.oss-cn-hangzhou.aliyuncs.com/task/task-foot-bg.png"}})])}],i=(e("da02"),e("5122"),e("d8d0")),o=e("02ac"),n={components:{TaskSpecstable:i["a"]},data:function(){return{goodsData:{name:"",slideshow:"",param_type:1,line_price:0,task:{task_number:0,task_price:0,goods_is_sale:0}},form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""}}},computed:{covers:function(){if(this.goodsData.slideshow){var t=this.goodsData.slideshow;if("[object Array]"===Object.prototype.toString.call(t))return t[0];if("[object String]"===Object.prototype.toString.call(t))try{return JSON.parse(t)}catch(s){return[this.ipAddress+"/le-default-goods-bg.png"]}}return[this.ipAddress+"/le-default-goods-bg.png"]}},filters:{capitalize:function(t){return t.length>=42?t.slice(0,39)+"...":t}},mounted:function(){this.$route.query.id?this.handleLoadData(this.$route.query.id):this.$message.error("商品找不到或不存在")},methods:{isPriceNumber:function(t){if("0"==t||"0."==t||"0.0"==t||"0.00"==t)return t="0",!0;var s=t.indexOf("0"),e=t.length;if(0==s&&e>1){var a=/^[0]{1}[.]{1}[0-9]{1,2}$/;return!!a.test(t)}a=/^[1-9]{1}[0-9]{0,10}[.]{0,1}[0-9]{0,2}$/;return!!a.test(t)},handleSubmit:function(t){var s=this,e=this.goodsData,a=!0;if(2==e.param_type){var r=this.handleAffirm();if(r){for(var i in r){var n=JSON.parse(JSON.stringify(r[i]));if(o["a"].isEmpty(n.task_stock))return this.$message.error("可兑换数量不能为空"),a=!1,!1;if(o["a"].isEmpty(n.task_number))return this.$message.error("积分值不能为空"),a=!1,!1;if(o["a"].isEmpty(n.task_price))return this.$message.error("积分价格不能为空"),a=!1,!1;if(o["a"].isFloat(n.task_stock))return this.$message.error("可兑换数量填写错误"),a=!1,!1;if(o["a"].isFloat(n.task_number))return this.$message.error("积分值填写错误"),a=!1,!1;if(o["a"].isFloat(n.task_limit))return this.$message.error("兑换限制填写错误"),a=!1,!1;if(!o["a"].isNumber(n.task_stock))return this.$message.error("可兑换数量必须是数字"),a=!1,!1;if(!o["a"].isNumber(n.task_number))return this.$message.error("积分值必须是数字"),a=!1,!1;if(!o["a"].isNumber(n.task_price))return this.$message.error("积分价格必须是数字"),a=!1,!1;if(!o["a"].isNumber(n.task_limit)&&!o["a"].isEmpty(n.task_limit))return this.$message.error("兑换限制必须是数字"),a=!1,!1;if(!o["a"].isIntNum(n.task_stock))return this.$message.error("可兑换数量不能为负数"),a=!1,!1;if(!o["a"].isIntNum(n.task_number))return this.$message.error("积分值不能为负数"),a=!1,!1;if(!o["a"].isIntNum(n.task_price))return this.$message.error("积分价格不能为负数"),a=!1,!1;if(!o["a"].isIntNum(n.task_limit)&&!o["a"].isEmpty(n.task_limit))return this.$message.error("兑换限制不能为负数"),a=!1,!1;if(o["a"].isLimit(n.task_stock,9999999))return this.$message.error("可兑换数量不能大于9999999"),a=!1,!1;if(o["a"].isLimit(n.task_number,9999999))return this.$message.error("积分值不能大于9999999"),a=!1,!1;if(o["a"].isLimit(n.task_price,9999999))return this.$message.error("积分价格不能大于9999999"),a=!1,!1;if(o["a"].isLimit(n.task_limit,9999999)&&!o["a"].isEmpty(n.task_limit))return this.$message.error("兑换限制不能大于9999999"),a=!1,!1;if(!o["a"].isPrice(n.task_price))return this.$message.error("积分价格格式不正确"),a=!1,!1;if(parseInt(n.task_limit)>parseInt(n.task_stock)&&parseInt(n.task_limit)>0)return this.$message.error("兑换限制不能大于可兑换数量"),a=!1,!1}e.param=r}else a=!1}else{var l=JSON.parse(JSON.stringify(e.task));if(o["a"].isEmpty(l.task_stock))return this.$message.error("可兑换数量不能为空"),a=!1,!1;if(o["a"].isEmpty(l.task_number))return this.$message.error("积分值不能为空"),a=!1,!1;if(o["a"].isEmpty(l.task_price))return this.$message.error("积分价格不能为空"),a=!1,!1;if(o["a"].isFloat(l.task_stock))return this.$message.error("可兑换数量填写错误"),a=!1,!1;if(o["a"].isFloat(l.task_number))return this.$message.error("积分值填写错误"),a=!1,!1;if(o["a"].isFloat(l.task_limit))return this.$message.error("兑换限制填写错误"),a=!1,!1;if(!o["a"].isNumber(l.task_stock))return this.$message.error("可兑换数量必须是数字"),a=!1,!1;if(!o["a"].isNumber(l.task_number))return this.$message.error("积分值必须是数字"),a=!1,!1;if(!o["a"].isNumber(l.task_price))return this.$message.error("积分价格必须是数字"),a=!1,!1;if(!o["a"].isNumber(l.task_limit)&&!o["a"].isEmpty(l.task_limit))return this.$message.error("兑换限制必须是数字"),a=!1,!1;if(!o["a"].isIntNum(l.task_stock))return this.$message.error("可兑换数量不能为负数"),a=!1,!1;if(!o["a"].isIntNum(l.task_number))return this.$message.error("积分值不能为负数"),a=!1,!1;if(!o["a"].isIntNum(l.task_price))return this.$message.error("积分价格不能为负数"),a=!1,!1;if(!o["a"].isIntNum(l.task_limit)&&!o["a"].isEmpty(l.task_limit))return this.$message.error("兑换限制不能为负数"),a=!1,!1;if(o["a"].isLimit(l.task_stock,9999999))return this.$message.error("可兑换数量不能大于9999999"),a=!1,!1;if(o["a"].isLimit(l.task_number,9999999))return this.$message.error("积分值不能大于9999999"),a=!1,!1;if(o["a"].isLimit(l.task_price,9999999))return this.$message.error("积分价格不能大于9999999"),a=!1,!1;if(o["a"].isLimit(l.task_limit,9999999)&&!o["a"].isEmpty(l.task_limit))return this.$message.error("兑换限制不能大于9999999"),a=!1,!1;if(!o["a"].isPrice(l.task_price))return this.$message.error("积分价格格式不正确"),a=!1,!1;if(parseInt(l.task_limit)>parseInt(l.task_stock)&&parseInt(l.task_limit)>0)return this.$message.error("兑换限制不能大于可兑换数量"),a=!1,!1}var m={goods_is_sale:e.task.goods_is_sale,goods_list:[e]};a&&this.$heshop.plugin("post",{include:"task",model:"goods"},m).then((function(t){s.$message({message:"保存成功",type:"success"})})).catch((function(t){s.$message.error("保存失败，请检查规格参数是否设置正确")}))},isInteger:function(t){return t%1===0},handleAffirm:function(){var t=this.$refs["specstable"].tableData;if(t){for(var s in t){var e=t[s];if(e.task_number<0||null==e.task_number)return this.$message.error("兑换积分不能为空，不能为负数"),!1;if(e.task_price<0||null==e.task_price)return this.$message.error("兑换价格不能为空"),!1;if(e.task_stock<0||null==e.task_stock)return this.$message.error("可兑换数量不能为空"),!1;if(!this.isInteger(e.task_limit))return this.$message.error("兑换限制必须为整数"),!1;if(!this.isInteger(e.task_number))return this.$message.error("积分值必须为整数"),!1;if(!this.isInteger(e.task_stock))return this.$message.error("可兑换数量必须为整数"),!1;if(e.task_limit>e.task_stock)return this.$message.error("兑换限制不能大于可兑换数量"),!1}return t}return this.$message.error("请先设置规格数据"),!1},handleLoadData:function(t){var s=this;this.$heshop.plugin("get",{id:t,include:"task",model:"goods"}).then((function(t){s.goodsData=t})).catch((function(t){s.$message.error("获取失败，请检查网络")}))}}},l=n,m=(e("a9f5"),e("cba8")),c=Object(m["a"])(l,a,r,!1,null,"e12b52d6",null);s["default"]=c.exports}}]);