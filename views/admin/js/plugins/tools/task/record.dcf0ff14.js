(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["plugins/tools/task/record"],{9326:function(t,e,a){},bd6b:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-content"},[a("div",{staticClass:"__search"},[a("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formValue,rules:t.rules,"label-width":"100px"}},[a("div",[a("el-form-item",{attrs:{label:"用户搜索"}},[a("el-input",{attrs:{placeholder:"输入用户昵称/用户ID搜索",clearable:""},on:{clear:t.onSubmit},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit.apply(null,arguments)}},model:{value:t.formValue.search,callback:function(e){t.$set(t.formValue,"search",e)},expression:"formValue.search"}})],1),a("el-form-item",{attrs:{label:"积分收支",prop:"score_start"}},[a("el-input",{attrs:{placeholder:"积分的最低值"},model:{value:t.formValue.score_start,callback:function(e){t.$set(t.formValue,"score_start",e)},expression:"formValue.score_start"}}),a("span",{staticStyle:{display:"inline-block",width:"47px",height:"32px","line-height":"32px","text-align":"center"}},[t._v("至")]),a("el-form-item",{staticStyle:{display:"inline-block","margin-bottom":"0"},attrs:{prop:"score_end"}},[a("el-input",{attrs:{placeholder:"积分的最高值"},on:{change:t.handleChange},model:{value:t.formValue.score_end,callback:function(e){t.$set(t.formValue,"score_end",e)},expression:"formValue.score_end"}})],1)],1)],1),a("div",[a("el-form-item",{attrs:{label:"变动时间"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:t.formValue.date,callback:function(e){t.$set(t.formValue,"date",e)},expression:"formValue.date"}})],1)],1),a("div",{staticStyle:{"padding-left":"100px"}},[a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("筛选")]),a("el-button",{on:{click:t.onEmpty}},[t._v("清空")])],1)],1)])],1),a("div",{staticClass:"__content",staticStyle:{"padding-top":"24px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"default-sort":{prop:"start_time",order:"descending"}},on:{"sort-change":t.handleSortMethod}},[a("el-table-column",{attrs:{prop:"UID",label:"用户","min-width":"312"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"__content_cover"},["weapp"==e.row.oauth.type?a("i",{staticClass:"le-icon le-icon-xiaochengxu",staticStyle:{color:"#623ceb"}}):a("i",{staticClass:"le-icon le-icon-weixin2",staticStyle:{color:"#3bb430"}}),a("div",{staticClass:"__content_title"},[a("h3",{staticClass:"task_tab_tl"},[t._v(t._s(e.row.user.nickname))]),a("p",[t._v("ID:"+t._s(e.row.UID))])])])]}}])}),a("el-table-column",{attrs:{prop:"number",label:"积分收支","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return["add"==e.row.type?a("p",{staticClass:"task_tab_tl",staticStyle:{color:"#53c41a"}},[t._v("+"+t._s(e.row.number))]):a("p",{staticClass:"task_tab_tl",staticStyle:{color:"#f5212d"}},[t._v(t._s(e.row.number))])]}}])}),a("el-table-column",{attrs:{prop:"order_id",label:"订单号","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.order_sn?a("he-link",{attrs:{href:"order/orderDetail",query:{order_sn:e.row.order_sn}}},[a("p",{staticClass:"task_tab_tl",staticStyle:{color:"#623ceb","font-weight":"400"}},[t._v(t._s(e.row.order_sn||"-"))])]):a("p",{staticClass:"task_tab_tl",staticStyle:{color:"#623ceb","font-weight":"400"}},[t._v("-")])]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"收支说明","min-width":"280"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{staticClass:"task_tab_tl"},[t._v(t._s(e.row.remark))])]}}])}),a("el-table-column",{attrs:{prop:"start_time",label:"变动时间",sortable:"custom","min-width":"280"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{staticClass:"task_tab_tl"},[t._v(t._s(t._f("dateFormat")(e.row.start_time)))])]}}])})],1),a("div",{staticClass:"__paging"},[a("el-pagination",{attrs:{"current-page":t.page.current,"page-count":t.page.count,background:"",layout:"prev, pager, next, jumper"},on:{"current-change":t.currentChange,"size-change":t.sizeChange}})],1)],1)])},s=[],o=a("9d6b"),n=(a("e186"),a("60d6"),a("5122"),a("dc87"),a("caaf")),i=a.n(n),l={data:function(){var t=this,e=function(e,a,r){var s=Number(t.formValue.score_start),o=t.formValue.score_end?Number(t.formValue.score_end):"";if(s){if(s%1!==0)return void r(new Error("积分必须是整数"));if((o||0===o)&&s>o)return void r(new Error("最低值需小于或等于最高值"))}r()};return{page:{size:20,current:1},tableData:[],formValue:{search:"",score_start:"",score_end:"",date:[]},rules:{score_start:[{validator:e,trigger:"blur"}]}}},filters:{dateFormat:function(t){return void 0===t?"":i()(1e3*t).format("YYYY-MM-DD HH:mm:ss")},capitalize:function(t){return t.length>=32?t.slice(0,29)+"...":t}},computed:{},created:function(){},watch:{},mounted:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.handleLogLoad();case 1:case"end":return e.stop()}}),e)})))()},methods:{handleChange:function(){this.$refs.ruleForm.validate((function(){}))},handleSortMethod:function(t){"ascending"==t.order&&(this.formValue["sort"]={"s.start_time":"ASC"}),"descending"==t.order&&(this.formValue["sort"]={"s.start_time":"DESC"}),null==t.order&&(this.formValue["sort"]={}),this.handleLogLoad()},onEmpty:function(){this.formValue={search:"",score_start:"",score_end:"",date:[]},this.$refs.ruleForm.resetFields(),this.handleLogLoad()},isInteger:function(t){return t%1===0},handleLogLoad:function(){var t=this,e=JSON.parse(JSON.stringify(this.formValue));if(this.isInteger(e.score_start))if(this.isInteger(e.score_end)){var a=this.page;this.$heshop.plugin("get",{include:"task",model:"user",keyword:JSON.stringify(e)}).page(a.current,a.size).then((function(e){if(e&&e.headers){var a=e.data,r=e.headers;t.page={current:+r["x-pagination-current-page"],count:+r["x-pagination-page-count"],size:+r["x-pagination-per-page"],total:+r["x-pagination-total-count"]},t.tableData=a}})).catch((function(){t.$message.error("加载配置信息失败，请检查网络")}))}else this.$message.error("积分必须是整数");else this.$message.error("积分必须是整数")},onSubmit:function(){this.handleLogLoad()},sizeChange:function(t){this.page.size=t,this.handleLogLoad(),this.$emit("request",{page:this.page,sort:this.order})},currentChange:function(t){this.page.current=t,this.handleLogLoad(),this.$emit("request",{page:this.page,sort:this.order})}}},c=l,u=(a("dd1b"),a("cba8")),d=Object(u["a"])(c,r,s,!1,null,"44dbd8b6",null);e["default"]=d.exports},dd1b:function(t,e,a){"use strict";a("9326")}}]);