(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c75a9a9"],{1168:function(e,r,t){"use strict";t("fe2f")},a0ce:function(e,r,t){"use strict";t.r(r);var i=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",staticClass:"le-main le-card",attrs:{rules:e.rules,model:e.form,"label-width":"217px"}},[t("el-form-item",{staticClass:"le-search--id",attrs:{label:"商品ID",prop:"my_goods_id"}},[t("el-input",{attrs:{disabled:e.disabledEdit,placeholder:"请输入商品ID获取"},model:{value:e.form.my_goods_id,callback:function(r){e.$set(e.form,"my_goods_id",e._n(r))},expression:"form.my_goods_id"}},[t("el-button",{attrs:{slot:"append"},on:{click:e.getGoodDetail},slot:"append"},[e._v("获取")])],1)],1),t("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[t("el-input",{attrs:{disabled:e.disabledEdit,maxlength:"14","show-word-limit":"",placeholder:"请输入商品名称"},model:{value:e.form.goods_name,callback:function(r){e.$set(e.form,"goods_name",r)},expression:"form.goods_name"}})],1),t("el-form-item",{attrs:{label:"商品封面",prop:"pic_url"}},[t("div",{staticClass:"select-cover__120",class:[e.disabledEdit?"le-still":""]},[t("pictureDialog",{attrs:{disabled:e.disabledEdit,limit:1},scopedSlots:e._u([{key:"preview",fn:function(r){return t("div",{staticClass:"select-cover__120-edit"},[t("el-image",{attrs:{src:r.url,fit:"cover"}}),e.disabledEdit?e._e():t("div",{staticClass:"select-cover__120-tips"},[t("span",[e._v("替换")]),e._v(" | "),t("span",{on:{click:function(r){return r.stopPropagation(),function(r){return e.form.pic_url=""}()}}},[e._v("删除")])])],1)}}]),model:{value:e.form.pic_url,callback:function(r){e.$set(e.form,"pic_url",r)},expression:"form.pic_url"}},[t("div",{staticClass:"select-cover__120-add",attrs:{slot:"upload"},slot:"upload"},[t("i",{staticClass:"le-icon le-icon-add select-cover__120-icon"}),t("span",{staticClass:"select-cover__120-text"},[e._v("添加图片")])])])],1),t("div",{staticClass:"le-prompt-text"},[e._v(" 建议尺寸：300像素 * 300像素，图片大小不得超过1M ")])]),t("el-form-item",{attrs:{label:"商品价格",prop:"price_type"}},[t("el-radio-group",{on:{change:e.priceTypeChange},model:{value:e.form.price_type,callback:function(r){e.$set(e.form,"price_type",r)},expression:"form.price_type"}},[t("el-radio",{attrs:{label:1}},[e._v("一口价")]),t("el-radio",{attrs:{label:2}},[e._v("价格区间")]),t("el-radio",{attrs:{label:3}},[e._v("折扣价")])],1),1===e.form.price_type?t("div",[t("el-input",{on:{input:function(r){return e.formatNum(e.form.price,"price")}},model:{value:e.form.price,callback:function(r){e.$set(e.form,"price",r)},expression:"form.price"}},[t("template",{slot:"append"},[e._v("元")])],2)],1):2===e.form.price_type?t("div",{staticClass:"le-small-input"},[t("el-input",{on:{input:function(r){return e.formatNum(e.form.price,"price")}},model:{value:e.form.price,callback:function(r){e.$set(e.form,"price",r)},expression:"form.price"}},[t("template",{slot:"append"},[e._v("元")])],2),t("span",[e._v("至")]),t("el-input",{on:{input:function(r){return e.formatNum(e.form.price2,"price2")}},model:{value:e.form.price2,callback:function(r){e.$set(e.form,"price2",r)},expression:"form.price2"}},[t("template",{slot:"append"},[e._v("元")])],2)],1):3===e.form.price_type?t("div",{staticClass:"le-small-input"},[t("span",[e._v("原价")]),t("el-input",{on:{input:function(r){return e.formatNum(e.form.price,"price")}},model:{value:e.form.price,callback:function(r){e.$set(e.form,"price",r)},expression:"form.price"}},[t("template",{slot:"append"},[e._v("元")])],2),t("span",[e._v("现价")]),t("el-input",{on:{input:function(r){return e.formatNum(e.form.price2,"price2")}},model:{value:e.form.price2,callback:function(r){e.$set(e.form,"price2",r)},expression:"form.price2"}},[t("template",{slot:"append"},[e._v("元")])],2)],1):e._e()],1),e.is_show?e._e():t("el-form-item",{attrs:{label:"商品路径",prop:"page_url"}},[t("el-input",{attrs:{disabled:e.disabledEdit,placeholder:"请输入商品ID"},model:{value:e.form.page_url,callback:function(r){e.$set(e.form,"page_url",r)},expression:"form.page_url"}},[t("template",{slot:"prepend"},[e._v("pages/goods/detail?id=")])],2)],1),e.is_show?t("el-form-item",{attrs:{label:"小程序路径",prop:"page_url"}},[t("el-input",{attrs:{disabled:e.disabledEdit,placeholder:""},model:{value:e.form.page_url,callback:function(r){e.$set(e.form,"page_url",r)},expression:"form.page_url"}}),t("div",{staticClass:"le-prompt-text"},[e._v(" 请确保小程序页面路径可被访问。 例如：pages/index/index.html?query_id=test_value ")])],1):e._e()],1),t("div",{staticClass:"le-cardpin"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submit}},[e._v("保存")])],1)],1)},o=[],a=t("1da1"),l=(t("96cf"),t("b0c0"),t("d3b7"),t("25f0"),t("5319"),t("ac1f"),{data:function(){var e=this,r=function(e,r,t){isNaN(r)&&t("请输入正整数"),t()},t=function(r,t,i){1===t?e.form.price||i("请输入商品价格"):2===t?(e.form.price&&e.form.price2||i("请输入商品价格"),e.form.price>e.form.price2&&i("请正确书写价格区间")):3===t&&(e.form.price&&e.form.price2||i("请输入商品价格")),i()},i=function(e,r,t){r.length>14&&t("商品名称最大为14字符"),t()},o=function(r,t,i){t||(e.is_show?i("请输入完整小程序路径"):i("请输入商品ID")),i()};return{is_show:null,form:{my_goods_id:null,goods_name:"",pic_url:"",price_type:1,price:"",price2:"",page_url:""},rules:{my_goods_id:[{validator:r,trigger:"blur"}],price_type:[{required:!0,message:"请输入商品价格",trigger:"blur"},{validator:t,trigger:"blur"}],pic_url:[{required:!0,message:"请添加商品封面",trigger:"blur"}],goods_name:[{required:!0,message:"请添加商品名称",trigger:"blur"},{validator:i,trigger:"blur"}],page_url:[{required:!0,validator:o,trigger:"blur"}]},loading:!1}},computed:{disabledEdit:function(){return this.$route.query.status&&"2"===this.$route.query.status}},created:function(){},watch:{},mounted:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var t,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t=e.$route.query.goodsId,t&&(i=JSON.parse(localStorage.getItem("editLiveGood")),e.form=i,i.is_show||(e.is_show=!0),e.form={my_goods_id:null,goods_name:i.name,pic_url:i.cover_img_base64,price_type:i.price_type,price:i.price,price2:i.price2,page_url:i.new_url,goods_id:i.goods_id});case 2:case"end":return r.stop()}}),r)})))()},methods:{priceTypeChange:function(){this.form.price="",this.form.price2="",this.$refs["form"].clearValidate("price_type")},getGoodDetail:function(){var e=this;this.$refs["form"].clearValidate(),this.loading=!0,this.$heshop.goods("get",parseInt(this.form.my_goods_id)).then((function(r){e.form.pic_url=r.slideshow[0],e.form.goods_name=r.name,e.form.page_url=e.form.my_goods_id,r.name.length>14&&e.$refs["form"].validateField("goods_name"),e.loading=!1})).catch((function(r){e.loading=!1,e.$heshop.error(r.data.message)}))},submit:function(){var e=this;this.$refs["form"].clearValidate(),this.$refs["form"].validate((function(r){if(r){e.loading=!0;var t=JSON.parse(JSON.stringify(e.form));delete t.my_goods_id,e.$heshop.livegoods("post",t).then((function(){e.loading=!1,e.$router.back()})).catch((function(r){e.loading=!1,e.$message.error(r.data.message)}))}}))},formatNum:function(e,r){var t=e.toString();t=t.replace(/。/g,"."),t=t.replace(/[^\d.]/g,""),t=t.replace(/^\./g,""),t=t.replace(/\.{2,}/g,""),t=t.replace(".","$#$").replace(/\./g,"").replace("$#$","."),t=t.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),this.form[r]=t}}}),s=l,n=(t("1168"),t("2877")),c=Object(n["a"])(s,i,o,!1,null,"da25b74e",null);r["default"]=c.exports},fe2f:function(e,r,t){}}]);